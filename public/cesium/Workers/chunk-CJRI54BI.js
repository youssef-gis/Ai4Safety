import{a as t}from"./chunk-T77EB7BE.js";import{a as e}from"./chunk-APG2S62J.js";import{a as i}from"./chunk-T6Q6HX5J.js";import{a as n}from"./chunk-4MJDNHOT.js";import{b as a,c as r,d as o}from"./chunk-EDF5FKWJ.js";import{d as m}from"./chunk-XQIJGAVD.js";import{a as s}from"./chunk-RCHWDG3R.js";import{a as c,c as u,d as l,f as f}from"./chunk-KWAHJ72S.js";import{a as p}from"./chunk-MKDADUG3.js";import{a as h}from"./chunk-NOIUI5SY.js";import{e as _}from"./chunk-XRRBRTKL.js";var d,k=new c,A=new c,y=new c,w=new c,x=new c,P=new c(1,1,1),v=Math.cos,C=Math.sin;function b(t){let i=(t=t??f.EMPTY_OBJECT).radii??P,n=t.innerRadii??i,a=t.minimumClock??0,r=t.maximumClock??p.TWO_PI,o=t.minimumCone??0,m=t.maximumCone??p.PI,s=Math.round(t.stackPartitions??64),u=Math.round(t.slicePartitions??64),l=t.vertexFormat??e.DEFAULT;if(u<3)throw new h("options.slicePartitions cannot be less than three.");if(s<3)throw new h("options.stackPartitions cannot be less than three.");this._radii=c.clone(i),this._innerRadii=c.clone(n),this._minimumClock=a,this._maximumClock=r,this._minimumCone=o,this._maximumCone=m,this._stackPartitions=s,this._slicePartitions=u,this._vertexFormat=e.clone(l),this._offsetAttribute=t.offsetAttribute,this._workerName="createEllipsoidGeometry"}b.packedLength=2*c.packedLength+e.packedLength+7,b.pack=function(t,i,n){if(!_(t))throw new h("value is required");if(!_(i))throw new h("array is required");return n=n??0,c.pack(t._radii,i,n),n+=c.packedLength,c.pack(t._innerRadii,i,n),n+=c.packedLength,e.pack(t._vertexFormat,i,n),n+=e.packedLength,i[n++]=t._minimumClock,i[n++]=t._maximumClock,i[n++]=t._minimumCone,i[n++]=t._maximumCone,i[n++]=t._stackPartitions,i[n++]=t._slicePartitions,i[n]=t._offsetAttribute??-1,i};var g=new c,T=new c,F=new e,L={radii:g,innerRadii:T,vertexFormat:F,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,offsetAttribute:void 0};b.unpack=function(t,i,n){if(!_(t))throw new h("array is required");i=i??0;let a=c.unpack(t,i,g);i+=c.packedLength;let r=c.unpack(t,i,T);i+=c.packedLength;let o=e.unpack(t,i,F);i+=e.packedLength;let m=t[i++],s=t[i++],u=t[i++],l=t[i++],f=t[i++],p=t[i++],d=t[i];return _(n)?(n._radii=c.clone(a,n._radii),n._innerRadii=c.clone(r,n._innerRadii),n._vertexFormat=e.clone(o,n._vertexFormat),n._minimumClock=m,n._maximumClock=s,n._minimumCone=u,n._maximumCone=l,n._stackPartitions=f,n._slicePartitions=p,n._offsetAttribute=-1===d?void 0:d,n):(L.minimumClock=m,L.maximumClock=s,L.minimumCone=u,L.maximumCone=l,L.stackPartitions=f,L.slicePartitions=p,L.offsetAttribute=-1===d?void 0:d,new b(L))},b.createGeometry=function(e){let f,h,d,P,b=e._radii;if(b.x<=0||b.y<=0||b.z<=0)return;let g=e._innerRadii;if(g.x<=0||g.y<=0||g.z<=0)return;let T=e._minimumClock,F=e._maximumClock,L=e._minimumCone,I=e._maximumCone,O=e._vertexFormat,D=e._slicePartitions+1,M=e._stackPartitions+1;D=Math.round(D*Math.abs(F-T)/p.TWO_PI),M=Math.round(M*Math.abs(I-L)/p.PI),D<2&&(D=2),M<2&&(M=2);let E,N,R=0,z=[L],j=[T];for(E=0;E<M;E++)z.push(L+E*(I-L)/(M-1));for(z.push(I),N=0;N<D;N++)j.push(T+N*(F-T)/(D-1));j.push(F);let G=z.length,U=j.length,S=0,J=1,W=g.x!==b.x||g.y!==b.y||g.z!==b.z,B=!1,K=!1,H=!1;W&&(J=2,L>0&&(B=!0,S+=D-1),I<Math.PI&&(K=!0,S+=D-1),(F-T)%p.TWO_PI?(H=!0,S+=(M-1)*2+1):S+=1);let X=U*G*J,Y=new Float64Array(3*X),q=Array(X).fill(!1),Q=Array(X).fill(!1),V=D*M*J,Z=6*(V+S+1-(D+M)*J),$=i.createTypedArray(V,Z),tt=O.normal?new Float32Array(3*X):void 0,te=O.tangent?new Float32Array(3*X):void 0,ti=O.bitangent?new Float32Array(3*X):void 0,tn=O.st?new Float32Array(2*X):void 0,ta=Array(G),tr=Array(G);for(E=0;E<G;E++)ta[E]=C(z[E]),tr[E]=v(z[E]);let to=Array(U),tm=Array(U);for(N=0;N<U;N++)tm[N]=v(j[N]),to[N]=C(j[N]);for(E=0;E<G;E++)for(N=0;N<U;N++)Y[R++]=b.x*ta[E]*tm[N],Y[R++]=b.y*ta[E]*to[N],Y[R++]=b.z*tr[E];let ts=X/2;if(W)for(E=0;E<G;E++)for(N=0;N<U;N++)Y[R++]=g.x*ta[E]*tm[N],Y[R++]=g.y*ta[E]*to[N],Y[R++]=g.z*tr[E],q[ts]=!0,E>0&&E!==G-1&&0!==N&&N!==U-1&&(Q[ts]=!0),ts++;for(E=1,R=0;E<G-2;E++)for(f=E*U,h=(E+1)*U,N=1;N<U-2;N++)$[R++]=h+N,$[R++]=h+N+1,$[R++]=f+N+1,$[R++]=h+N,$[R++]=f+N+1,$[R++]=f+N;if(W){let t=G*U;for(E=1;E<G-2;E++)for(f=t+E*U,h=t+(E+1)*U,N=1;N<U-2;N++)$[R++]=h+N,$[R++]=f+N,$[R++]=f+N+1,$[R++]=h+N,$[R++]=f+N+1,$[R++]=h+N+1}if(W){if(B)for(P=G*U,E=1;E<U-2;E++)$[R++]=E,$[R++]=E+1,$[R++]=P+E+1,$[R++]=E,$[R++]=P+E+1,$[R++]=P+E;if(K)for(d=G*U-U,P=G*U*J-U,E=1;E<U-2;E++)$[R++]=d+E+1,$[R++]=d+E,$[R++]=P+E,$[R++]=d+E+1,$[R++]=P+E,$[R++]=P+E+1}if(H){for(E=1;E<G-2;E++)P=U*G+U*E,d=U*E,$[R++]=P,$[R++]=d+U,$[R++]=d,$[R++]=P,$[R++]=P+U,$[R++]=d+U;for(E=1;E<G-2;E++)P=U*G+U*(E+1)-1,d=U*(E+1)-1,$[R++]=d+U,$[R++]=P,$[R++]=d,$[R++]=d+U,$[R++]=P+U,$[R++]=P}let tc=new n;O.position&&(tc.position=new o({componentDatatype:s.DOUBLE,componentsPerAttribute:3,values:Y}));let tu=0,tl=0,tf=0,tp=0,th=X/2,t_,td=l.fromCartesian3(b),tk=l.fromCartesian3(g);if(O.st||O.normal||O.tangent||O.bitangent){for(E=0;E<X;E++){t_=q[E]?tk:td;let t=c.fromArray(Y,3*E,k),e=t_.geodeticSurfaceNormal(t,A);if(Q[E]&&c.negate(e,e),O.st){let t=u.negate(e,x);tn[tu++]=Math.atan2(t.y,t.x)/p.TWO_PI+.5,tn[tu++]=Math.asin(e.z)/Math.PI+.5}if(O.normal&&(tt[tl++]=e.x,tt[tl++]=e.y,tt[tl++]=e.z),O.tangent||O.bitangent){let t=0,i;if(q[E]&&(t=th),i=!B&&E>=t&&E<t+2*U?c.UNIT_X:c.UNIT_Z,c.cross(i,e,y),c.normalize(y,y),O.tangent&&(te[tf++]=y.x,te[tf++]=y.y,te[tf++]=y.z),O.bitangent){let t=c.cross(e,y,w);c.normalize(t,t),ti[tp++]=t.x,ti[tp++]=t.y,ti[tp++]=t.z}}}O.st&&(tc.st=new o({componentDatatype:s.FLOAT,componentsPerAttribute:2,values:tn})),O.normal&&(tc.normal=new o({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:tt})),O.tangent&&(tc.tangent=new o({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:te})),O.bitangent&&(tc.bitangent=new o({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:ti}))}if(_(e._offsetAttribute)){let i=Y.length,n=+(e._offsetAttribute!==t.NONE),a=new Uint8Array(i/3).fill(n);tc.applyOffset=new o({componentDatatype:s.UNSIGNED_BYTE,componentsPerAttribute:1,values:a})}return new r({attributes:tc,indices:$,primitiveType:a.TRIANGLES,boundingSphere:m.fromEllipsoid(td),offsetAttribute:e._offsetAttribute})},b.getUnitEllipsoid=function(){return _(d)||(d=b.createGeometry(new b({radii:new c(1,1,1),vertexFormat:e.POSITION_ONLY}))),d};var I=b;export{I as a};