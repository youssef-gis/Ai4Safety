import{a as e}from"./chunk-U6GWZBRL.js";import{a as t}from"./chunk-3BSRJTW3.js";import"./chunk-VHZAK4GN.js";import"./chunk-OFCC6BNI.js";import{a as n,b as o,c as r}from"./chunk-Q4W25C4L.js";import"./chunk-QORMFUM4.js";import"./chunk-FWF3VNA2.js";import{a as i}from"./chunk-APG2S62J.js";import"./chunk-ET7KY3BS.js";import"./chunk-CUP6SILZ.js";import{a as a,b as s}from"./chunk-IYO6TYGP.js";import{a as p}from"./chunk-AZLP5742.js";import"./chunk-5HPISDSZ.js";import"./chunk-HSJ6GSLC.js";import"./chunk-SXKYZMEL.js";import{a as c}from"./chunk-T6Q6HX5J.js";import{a as l}from"./chunk-4MJDNHOT.js";import{b as u,c as h,d as m}from"./chunk-EDF5FKWJ.js";import{d as k}from"./chunk-XQIJGAVD.js";import"./chunk-UTYWXSQT.js";import{a as g}from"./chunk-RCHWDG3R.js";import"./chunk-4WJUWBRK.js";import"./chunk-5G23AKP3.js";import{a as f,c as d,d as y,f as _}from"./chunk-KWAHJ72S.js";import{a as j}from"./chunk-MKDADUG3.js";import{a as v}from"./chunk-NOIUI5SY.js";import{e as L}from"./chunk-XRRBRTKL.js";function T(e){let t=(e=e??_.EMPTY_OBJECT).polylinePositions,o=e.shapePositions;if(!L(t))throw new v("options.polylinePositions is required.");if(!L(o))throw new v("options.shapePositions is required.");this._positions=t,this._shape=o,this._ellipsoid=y.clone(e.ellipsoid??y.default),this._cornerType=e.cornerType??n.ROUNDED,this._vertexFormat=i.clone(e.vertexFormat??i.DEFAULT),this._granularity=e.granularity??j.RADIANS_PER_DEGREE,this._workerName="createPolylineVolumeGeometry";let r=1+t.length*f.packedLength;r+=1+o.length*d.packedLength,this.packedLength=r+y.packedLength+i.packedLength+2}T.pack=function(e,t,n){if(!L(e))throw new v("value is required");if(!L(t))throw new v("array is required");n=n??0;let o,r=e._positions,a=r.length;for(t[n++]=a,o=0;o<a;++o,n+=f.packedLength)f.pack(r[o],t,n);let s=e._shape;for(a=s.length,t[n++]=a,o=0;o<a;++o,n+=d.packedLength)d.pack(s[o],t,n);return y.pack(e._ellipsoid,t,n),n+=y.packedLength,i.pack(e._vertexFormat,t,n),n+=i.packedLength,t[n++]=e._cornerType,t[n]=e._granularity,t};var P=y.clone(y.UNIT_SPHERE),A=new i,w={polylinePositions:void 0,shapePositions:void 0,ellipsoid:P,vertexFormat:A,cornerType:void 0,granularity:void 0};T.unpack=function(e,t,n){if(!L(e))throw new v("array is required");t=t??0;let o,r=e[t++],a=Array(r);for(o=0;o<r;++o,t+=f.packedLength)a[o]=f.unpack(e,t);let s=Array(r=e[t++]);for(o=0;o<r;++o,t+=d.packedLength)s[o]=d.unpack(e,t);let p=y.unpack(e,t,P);t+=y.packedLength;let c=i.unpack(e,t,A);t+=i.packedLength;let l=e[t++],u=e[t];return L(n)?(n._positions=a,n._shape=s,n._ellipsoid=y.clone(p,n._ellipsoid),n._vertexFormat=i.clone(c,n._vertexFormat),n._cornerType=l,n._granularity=u,n):(w.polylinePositions=a,w.shapePositions=s,w.cornerType=l,w.granularity=u,new T(w))};var F=new e;T.createGeometry=function(n){let i=p(n._positions,f.equalsEpsilon),d=n._shape;if(d=r.removeDuplicatesFromShape(d),i.length<2||d.length<3)return;s.computeWindingOrder2D(d)===a.CLOCKWISE&&d.reverse();let y=e.fromPoints(d,F);return function(e,n,r,i){let a=new l;i.position&&(a.position=new m({componentDatatype:g.DOUBLE,componentsPerAttribute:3,values:e}));let p=n.length,f=e.length/3,d=(f-2*p)/(2*p),y=s.triangulate(n),_=(d-1)*p*6+2*y.length,j=c.createTypedArray(f,_),v,L,T,P,A,w,F=2*p,S=0;for(v=0;v<d-1;v++){for(L=0;L<p-1;L++)w=(T=2*L+v*p*2)+F,A=(P=T+1)+F,j[S++]=P,j[S++]=T,j[S++]=A,j[S++]=A,j[S++]=T,j[S++]=w;A=(P=(T=2*p-2+v*p*2)+1)+F,w=T+F,j[S++]=P,j[S++]=T,j[S++]=A,j[S++]=A,j[S++]=T,j[S++]=w}if(i.st||i.tangent||i.bitangent){let e=new Float32Array(2*f),t=1/(d-1),o=1/r.height,i=r.height/2,s,c,l=0;for(v=0;v<d;v++){for(s=v*t,c=o*(n[0].y+i),e[l++]=s,e[l++]=c,L=1;L<p;L++)c=o*(n[L].y+i),e[l++]=s,e[l++]=c,e[l++]=s,e[l++]=c;c=o*(n[0].y+i),e[l++]=s,e[l++]=c}for(L=0;L<p;L++)s=0,c=o*(n[L].y+i),e[l++]=s,e[l++]=c;for(L=0;L<p;L++)s=(d-1)*t,c=o*(n[L].y+i),e[l++]=s,e[l++]=c;a.st=new m({componentDatatype:g.FLOAT,componentsPerAttribute:2,values:new Float32Array(e)})}let b=f-2*p;for(v=0;v<y.length;v+=3){let e=y[v]+b,t=y[v+1]+b,n=y[v+2]+b;j[S++]=e,j[S++]=t,j[S++]=n,j[S++]=n+p,j[S++]=t+p,j[S++]=e+p}let D=new h({attributes:a,indices:j,boundingSphere:k.fromVertices(e),primitiveType:u.TRIANGLES});if(i.normal&&(D=t.computeNormal(D)),i.tangent||i.bitangent){try{D=t.computeTangentAndBitangent(D)}catch{o("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}i.tangent||(D.attributes.tangent=void 0),i.bitangent||(D.attributes.bitangent=void 0),i.st||(D.attributes.st=void 0)}return D}(r.computePositions(i,d,y,n,!0),d,y,n._vertexFormat)};var S=function(e,t){return L(t)&&(e=T.unpack(e,t)),e._ellipsoid=y.clone(e._ellipsoid),T.createGeometry(e)};export{S as default};