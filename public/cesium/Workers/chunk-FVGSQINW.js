import{a as e,c as a}from"./chunk-Q4W25C4L.js";import{a as t}from"./chunk-QORMFUM4.js";import{g as r}from"./chunk-UTYWXSQT.js";import{a as n,e as l}from"./chunk-KWAHJ72S.js";import{a as o}from"./chunk-MKDADUG3.js";import{e as i}from"./chunk-XRRBRTKL.js";var s={},u=new n,c=new n,y=new n,m=new n,d=[new n,new n],p=new n,g=new n,h=new n,f=new n,z=new n,w=new n,x=new n,A=new n,B=new n,S=new n,E=new r,D=new l;function R(a,t,i,s,y){let m,d=n.angleBetween(n.subtract(t,a,u),n.subtract(i,a,c)),p=s===e.BEVELED?1:Math.ceil(d/o.toRadians(5))+1,g=3*p,h=Array(g);h[g-3]=i.x,h[g-2]=i.y,h[g-1]=i.z,m=y?l.fromQuaternion(r.fromAxisAngle(n.negate(a,u),d/p,E),D):l.fromQuaternion(r.fromAxisAngle(a,d/p,E),D);let f=0;t=n.clone(t,u);for(let e=0;e<p;e++)t=l.multiplyByVector(m,t,t),h[f++]=t.x,h[f++]=t.y,h[f++]=t.z;return h}function b(e,a,t,r){let l=u;return r||(a=n.negate(a,a)),[(l=n.add(e,a,l)).x,l.y,l.z,t.x,t.y,t.z]}function N(e,a,t,r){let l=Array(e.length),o=Array(e.length),i=n.multiplyByScalar(a,t,u),s=n.negate(i,c),d=0,p=e.length-1;for(let a=0;a<e.length;a+=3){let t=n.fromArray(e,a,y),r=n.add(t,s,m);l[d++]=r.x,l[d++]=r.y,l[d++]=r.z;let u=n.add(t,i,m);o[p--]=u.z,o[p--]=u.y,o[p--]=u.x}return r.push(l,o),r}s.addAttribute=function(e,a,t,r){let n=a.x,l=a.y,o=a.z;i(t)&&(e[t]=n,e[t+1]=l,e[t+2]=o),i(r)&&(e[r]=o,e[r-1]=l,e[r-2]=n)};var P=new n,U=new n;s.computePositions=function(r){var l;let i,s,c,y,m,E,D,v,O=r.granularity,j=r.positions,k=r.ellipsoid,L=r.width/2,M=r.cornerType,Q=r.saveAttributes,T=p,V=g,K=h,W=f,G=z,I=w,X=x,q=A,C=B,F=S,H=[],J=Q?[]:void 0,Y=Q?[]:void 0,Z=j[0],$=j[1];V=n.normalize(n.subtract($,Z,V),V),T=k.geodeticSurfaceNormal(Z,T),W=n.normalize(n.cross(T,V,W),W),Q&&(J.push(W.x,W.y,W.z),Y.push(T.x,T.y,T.z)),X=n.clone(Z,X),Z=$,K=n.negate(V,K);let _=[],ee,ea=j.length;for(ee=1;ee<ea-1;ee++){T=k.geodeticSurfaceNormal(Z,T),$=j[ee+1],V=n.normalize(n.subtract($,Z,V),V);let r=n.multiplyByScalar(T,n.dot(V,T),P);n.subtract(V,r,r),n.normalize(r,r);let l=n.multiplyByScalar(T,n.dot(K,T),U);if(n.subtract(K,l,l),n.normalize(l,l),!o.equalsEpsilon(Math.abs(n.dot(r,l)),1,o.EPSILON7)){G=n.normalize(n.add(V,K,G),G),G=n.cross(G,T,G),G=n.cross(T,G,G),G=n.normalize(G,G);let r=L/Math.max(.25,n.magnitude(n.cross(G,K,u))),l=a.angleIsGreaterThanPi(V,K,Z,k);G=n.multiplyByScalar(G,r,G),l?(q=n.add(Z,G,q),F=n.add(q,n.multiplyByScalar(W,L,F),F),C=n.add(q,n.multiplyByScalar(W,2*L,C),C),d[0]=n.clone(X,d[0]),d[1]=n.clone(F,d[1]),H=N(t.generateArc({positions:d,granularity:O,ellipsoid:k}),W,L,H),Q&&(J.push(W.x,W.y,W.z),Y.push(T.x,T.y,T.z)),I=n.clone(C,I),W=n.normalize(n.cross(T,V,W),W),C=n.add(q,n.multiplyByScalar(W,2*L,C),C),X=n.add(q,n.multiplyByScalar(W,L,X),X),M===e.ROUNDED||M===e.BEVELED?_.push({leftPositions:R(q,I,C,M,l)}):_.push({leftPositions:b(Z,n.negate(G,G),C,l)})):(C=n.add(Z,G,C),F=n.add(C,n.negate(n.multiplyByScalar(W,L,F),F),F),q=n.add(C,n.negate(n.multiplyByScalar(W,2*L,q),q),q),d[0]=n.clone(X,d[0]),d[1]=n.clone(F,d[1]),H=N(t.generateArc({positions:d,granularity:O,ellipsoid:k}),W,L,H),Q&&(J.push(W.x,W.y,W.z),Y.push(T.x,T.y,T.z)),I=n.clone(q,I),W=n.normalize(n.cross(T,V,W),W),q=n.add(C,n.negate(n.multiplyByScalar(W,2*L,q),q),q),X=n.add(C,n.negate(n.multiplyByScalar(W,L,X),X),X),M===e.ROUNDED||M===e.BEVELED?_.push({rightPositions:R(C,I,q,M,l)}):_.push({rightPositions:b(Z,G,q,l)})),K=n.negate(V,K)}Z=$}return T=k.geodeticSurfaceNormal(Z,T),d[0]=n.clone(X,d[0]),d[1]=n.clone(Z,d[1]),H=N(t.generateArc({positions:d,granularity:O,ellipsoid:k}),W,L,H),Q&&(J.push(W.x,W.y,W.z),Y.push(T.x,T.y,T.z)),M===e.ROUNDED&&(l=H,i=p,s=g,c=h,y=l[1],s=n.fromArray(l[1],y.length-3,s),c=n.fromArray(l[0],0,c),m=R(i=n.midpoint(s,c,i),s,c,e.ROUNDED,!1),E=l.length-1,D=l[E-1],y=l[E],s=n.fromArray(D,D.length-3,s),c=n.fromArray(y,0,c),v=[m,R(i=n.midpoint(s,c,i),s,c,e.ROUNDED,!1)]),{positions:H,corners:_,lefts:J,normals:Y,endPositions:v}};var v=s;export{v as a};