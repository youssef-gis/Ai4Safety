import{a as t}from"./chunk-FVGSQINW.js";import{a as e}from"./chunk-Q4W25C4L.js";import"./chunk-QORMFUM4.js";import"./chunk-FWF3VNA2.js";import{a as i}from"./chunk-T77EB7BE.js";import"./chunk-ET7KY3BS.js";import"./chunk-CUP6SILZ.js";import{b as r}from"./chunk-IYO6TYGP.js";import{a as o}from"./chunk-AZLP5742.js";import"./chunk-5HPISDSZ.js";import"./chunk-HSJ6GSLC.js";import"./chunk-SXKYZMEL.js";import{a as s}from"./chunk-T6Q6HX5J.js";import{a as n}from"./chunk-4MJDNHOT.js";import{b as a,c as l,d as h}from"./chunk-EDF5FKWJ.js";import{d as u}from"./chunk-XQIJGAVD.js";import"./chunk-UTYWXSQT.js";import{a as p}from"./chunk-RCHWDG3R.js";import"./chunk-4WJUWBRK.js";import"./chunk-5G23AKP3.js";import{a as f,d as c,f as d}from"./chunk-KWAHJ72S.js";import{a as g}from"./chunk-MKDADUG3.js";import{b as m}from"./chunk-NOIUI5SY.js";import{e as y}from"./chunk-XRRBRTKL.js";var A=new f,_=new f,b=new f;function k(i,r){let o=[],a=i.positions,l=i.corners,u=i.endPositions,c=new n,d,g=0,m=0,k,E=0,T;for(k=0;k<a.length;k+=2)g+=T=a[k].length-3,E+=T/3*4,m+=a[k+1].length-3;for(g+=3,m+=3,k=0;k<l.length;k++){d=l[k];let t=l[k].leftPositions;y(t)?g+=T=t.length:m+=T=l[k].rightPositions.length,E+=T/3*2}let j=y(u),v;j&&(g+=v=u[0].length-3,m+=v,v/=3,E+=4*v);let w=g+m,O=new Float64Array(w),P=0,D=w-1,H,S,L,N,G,I,U=v/2,R=s.createTypedArray(w/3,E+4),x=0;if(R[x++]=P/3,R[x++]=(D-2)/3,j){o.push(P/3),I=A,G=_;let e=u[0];for(k=0;k<U;k++)I=f.fromArray(e,(U-1-k)*3,I),G=f.fromArray(e,(U+k)*3,G),t.addAttribute(O,G,P),t.addAttribute(O,I,void 0,D),N=(S=P/3)+1,L=(H=(D-2)/3)-1,R[x++]=H,R[x++]=L,R[x++]=S,R[x++]=N,P+=3,D-=3}let B=0,M=a[B++],F=a[B++];for(O.set(M,P),O.set(F,D-F.length+1),T=F.length-3,o.push(P/3,(D-2)/3),k=0;k<T;k+=3)N=(S=P/3)+1,L=(H=(D-2)/3)-1,R[x++]=H,R[x++]=L,R[x++]=S,R[x++]=N,P+=3,D-=3;for(k=0;k<l.length;k++){let i,s=(d=l[k]).leftPositions,n=d.rightPositions,h,u=b;if(y(s)){for(D-=3,h=L,o.push(N),i=0;i<s.length/3;i++)u=f.fromArray(s,3*i,u),R[x++]=h-i-1,R[x++]=h-i,t.addAttribute(O,u,void 0,D),D-=3;o.push(h-Math.floor(s.length/6)),r===e.BEVELED&&o.push((D-2)/3+1),P+=3}else{for(P+=3,h=N,o.push(L),i=0;i<n.length/3;i++)u=f.fromArray(n,3*i,u),R[x++]=h+i,R[x++]=h+i+1,t.addAttribute(O,u,P),P+=3;o.push(h+Math.floor(n.length/6)),r===e.BEVELED&&o.push(P/3-1),D-=3}for(M=a[B++],F=a[B++],M.splice(0,3),F.splice(F.length-3,3),O.set(M,P),O.set(F,D-F.length+1),T=F.length-3,i=0;i<F.length;i+=3)S=(N=P/3)-1,H=(L=(D-2)/3)+1,R[x++]=H,R[x++]=L,R[x++]=S,R[x++]=N,P+=3,D-=3;P-=3,D+=3,o.push(P/3,(D-2)/3)}if(j){P+=3,D-=3,I=A,G=_;let e=u[1];for(k=0;k<U;k++)I=f.fromArray(e,(v-k-1)*3,I),G=f.fromArray(e,3*k,G),t.addAttribute(O,I,void 0,D),t.addAttribute(O,G,P),S=(N=P/3)-1,H=(L=(D-2)/3)+1,R[x++]=H,R[x++]=L,R[x++]=S,R[x++]=N,P+=3,D-=3;o.push(P/3)}else o.push(P/3,(D-2)/3);return R[x++]=P/3,R[x++]=(D-2)/3,c.position=new h({componentDatatype:p.DOUBLE,componentsPerAttribute:3,values:O}),{attributes:c,indices:R,wallIndices:o}}function E(t){let i=(t=t??d.EMPTY_OBJECT).positions,r=t.width;m.typeOf.object("options.positions",i),m.typeOf.number("options.width",r);let o=t.height??0,s=t.extrudedHeight??o;this._positions=i,this._ellipsoid=c.clone(t.ellipsoid??c.default),this._width=r,this._height=Math.max(o,s),this._extrudedHeight=Math.min(o,s),this._cornerType=t.cornerType??e.ROUNDED,this._granularity=t.granularity??g.RADIANS_PER_DEGREE,this._offsetAttribute=t.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+i.length*f.packedLength+c.packedLength+6}E.pack=function(t,e,i){m.typeOf.object("value",t),m.typeOf.object("array",e),i=i??0;let r=t._positions,o=r.length;e[i++]=o;for(let t=0;t<o;++t,i+=f.packedLength)f.pack(r[t],e,i);return c.pack(t._ellipsoid,e,i),i+=c.packedLength,e[i++]=t._width,e[i++]=t._height,e[i++]=t._extrudedHeight,e[i++]=t._cornerType,e[i++]=t._granularity,e[i]=t._offsetAttribute??-1,e};var T=c.clone(c.UNIT_SPHERE),j={positions:void 0,ellipsoid:T,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};E.unpack=function(t,e,i){m.typeOf.object("array",t),e=e??0;let r=t[e++],o=Array(r);for(let i=0;i<r;++i,e+=f.packedLength)o[i]=f.unpack(t,e);let s=c.unpack(t,e,T);e+=c.packedLength;let n=t[e++],a=t[e++],l=t[e++],h=t[e++],u=t[e++],p=t[e];return y(i)?(i._positions=o,i._ellipsoid=c.clone(s,i._ellipsoid),i._width=n,i._height=a,i._extrudedHeight=l,i._cornerType=h,i._granularity=u,i._offsetAttribute=-1===p?void 0:p,i):(j.positions=o,j.width=n,j.height=a,j.extrudedHeight=l,j.cornerType=h,j.granularity=u,j.offsetAttribute=-1===p?void 0:p,new E(j))},E.createGeometry=function(e){let n=e._positions,c=e._width,d=e._ellipsoid,m=o(n=function(t,e){for(let i=0;i<t.length;i++)t[i]=e.scaleToGeodeticSurface(t[i],t[i]);return t}(n,d),f.equalsEpsilon);if(m.length<2||c<=0)return;let A=e._height,_=e._extrudedHeight,b=!g.equalsEpsilon(A,_,0,g.EPSILON2),E={ellipsoid:d,positions:m,width:c,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!1},T;if(b)E.height=A,E.extrudedHeight=_,E.offsetAttribute=e._offsetAttribute,T=function(e){let o,n,a=e.ellipsoid,l=k(t.computePositions(e),e.cornerType),u=l.wallIndices,f=e.height,c=e.extrudedHeight,d=l.attributes,g=l.indices,m=d.position.values,A=m.length,_=new Float64Array(A);_.set(m);let b=new Float64Array(2*A);if(m=r.scaleToGeodeticHeight(m,f,a),_=r.scaleToGeodeticHeight(_,c,a),b.set(m),b.set(_,A),d.position.values=b,A/=3,y(e.offsetAttribute)){let t=new Uint8Array(2*A);if(e.offsetAttribute===i.TOP)t=t.fill(1,0,A);else{let r=+(e.offsetAttribute!==i.NONE);t=t.fill(r)}d.applyOffset=new h({componentDatatype:p.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}let E,T=g.length,j=s.createTypedArray(b.length/3,(T+u.length)*2);j.set(g);let v=T;for(E=0;E<T;E+=2){let t=g[E],e=g[E+1];j[v++]=t+A,j[v++]=e+A}for(E=0;E<u.length;E++)n=(o=u[E])+A,j[v++]=o,j[v++]=n;return{attributes:d,indices:j}}(E);else if((T=k(t.computePositions(E),E.cornerType)).attributes.position.values=r.scaleToGeodeticHeight(T.attributes.position.values,A,d),y(e._offsetAttribute)){let t=T.attributes.position.values.length,r=+(e._offsetAttribute!==i.NONE),o=new Uint8Array(t/3).fill(r);T.attributes.applyOffset=new h({componentDatatype:p.UNSIGNED_BYTE,componentsPerAttribute:1,values:o})}let j=T.attributes,v=u.fromVertices(j.position.values,void 0,3);return new l({attributes:j,indices:T.indices,primitiveType:a.LINES,boundingSphere:v,offsetAttribute:e._offsetAttribute})};var v=function(t,e){return y(e)&&(t=E.unpack(t,e)),t._ellipsoid=c.clone(t._ellipsoid),E.createGeometry(t)};export{v as default};