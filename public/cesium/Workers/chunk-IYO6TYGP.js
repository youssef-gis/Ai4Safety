import{a as e}from"./chunk-5HPISDSZ.js";import{b as t,c as n,d as r}from"./chunk-EDF5FKWJ.js";import{a as i}from"./chunk-RCHWDG3R.js";import{a as a}from"./chunk-4WJUWBRK.js";import{a as u,b as x,c as l,d as o}from"./chunk-KWAHJ72S.js";import{a as p}from"./chunk-MKDADUG3.js";import{b as f}from"./chunk-NOIUI5SY.js";import{e as y}from"./chunk-XRRBRTKL.js";var s={CLOCKWISE:a.CW,COUNTER_CLOCKWISE:a.CCW};s.validate=function(e){return e===s.CLOCKWISE||e===s.COUNTER_CLOCKWISE};var h=Object.freeze(s);function c(e,t,n,r,i){let a;if(i===function(e,t,n,r){let i=0;for(let a=t,u=n-r;a<n;a+=r)i+=(e[u]-e[a])*(e[a+1]+e[u+1]),u=a;return i}(e,t,n,r)>0)for(let i=t;i<n;i+=r)a=R(i/r|0,e[i],e[i+1],a);else for(let i=n-r;i>=t;i-=r)a=R(i/r|0,e[i],e[i+1],a);return a&&S(a,a.next)&&(z(a),a=a.next),a}function m(e,t){if(!e)return e;t||(t=e);let n=e,r;do if(r=!1,!n.steiner&&(S(n,n.next)||0===A(n.prev,n,n.next))){if(z(n),(n=t=n.prev)===n.next)break;r=!0}else n=n.next;while(r||n!==t);return t}function d(e,t){let n=e.x-t.x;return 0===n&&0==(n=e.y-t.y)&&(n=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)),n}function v(e,t,n,r,i){return(e=((e=((e=((e=((e=(e-n)*i|0)|e<<8)&0xff00ff)|e<<4)&0xf0f0f0f)|e<<2)&0x33333333)|e<<1)&0x55555555)|(t=((t=((t=((t=((t=(t-r)*i|0)|t<<8)&0xff00ff)|t<<4)&0xf0f0f0f)|t<<2)&0x33333333)|t<<1)&0x55555555)<<1}function g(e,t,n,r,i,a,u,x){return(i-u)*(t-x)>=(e-u)*(a-x)&&(e-u)*(r-x)>=(n-u)*(t-x)&&(n-u)*(a-x)>=(i-u)*(r-x)}function w(e,t,n,r,i,a,u,x){return(e!==u||t!==x)&&g(e,t,n,r,i,a,u,x)}function A(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function S(e,t){return e.x===t.x&&e.y===t.y}function b(e,t,n,r){let i=E(A(e,t,n)),a=E(A(e,t,r)),u=E(A(n,r,e)),x=E(A(n,r,t));return!!(i!==a&&u!==x||0===i&&M(e,n,t)||0===a&&M(e,r,t)||0===u&&M(n,e,r)||0===x&&M(n,t,r))}function M(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function E(e){return e>0?1:e<0?-1:0}function O(e,t){return 0>A(e.prev,e,e.next)?A(e,t,e.next)>=0&&A(e,e.prev,t)>=0:0>A(e,t,e.prev)||0>A(e,e.next,t)}function Z(e,t){let n=C(e.i,e.x,e.y),r=C(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function R(e,t,n,r){let i=C(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function z(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function C(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}var D=new u,T=new u,B={};B.computeArea2D=function(e){f.defined("positions",e),f.typeOf.number.greaterThanOrEquals("positions.length",e.length,3);let t=e.length,n=0;for(let r=t-1,i=0;i<t;r=i++){let t=e[r],a=e[i];n+=t.x*a.y-a.x*t.y}return .5*n},B.computeWindingOrder2D=function(e){return B.computeArea2D(e)>0?h.COUNTER_CLOCKWISE:h.CLOCKWISE},B.triangulate=function(e,t){return f.defined("positions",e),function(e,t,n=2){let r,i,a,u=t&&t.length,x=u?t[0]*n:e.length,l=c(e,0,x,n,!0),o=[];if(!l||l.next===l.prev)return o;if(u&&(l=function(e,t,n,r){let i=[];for(let n=0,a=t.length;n<a;n++){let u=t[n]*r,x=n<a-1?t[n+1]*r:e.length,l=c(e,u,x,r,!1);l===l.next&&(l.steiner=!0),i.push(function(e){let t=e,n=e;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==e);return n}(l))}i.sort(d);for(let e=0;e<i.length;e++)n=function(e,t){let n=function(e,t){let n=t,r=e.x,i=e.y,a=-1/0,u;if(S(e,n))return n;do{if(S(e,n.next))return n.next;if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){let e=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=r&&e>a&&(a=e,u=n.x<n.next.x?n:n.next,e===r))return u}n=n.next}while(n!==t);if(!u)return null;let x=u,l=u.x,o=u.y,p=1/0;n=u;do{if(r>=n.x&&n.x>=l&&r!==n.x&&g(i<o?r:a,i,l,o,i<o?a:r,i,n.x,n.y)){var f,y;let t=Math.abs(i-n.y)/(r-n.x);O(n,e)&&(t<p||t===p&&(n.x>u.x||n.x===u.x&&(f=u,y=n,0>A(f.prev,f,y.prev)&&0>A(y.next,f,f.next))))&&(u=n,p=t)}n=n.next}while(n!==x);return u}(e,t);if(!n)return t;let r=Z(n,e);return m(r,r.next),m(n,n.next)}(i[e],n);return n}(e,t,l,n)),e.length>80*n){r=e[0],i=e[1];let t=r,u=i;for(let a=n;a<x;a+=n){let n=e[a],x=e[a+1];n<r&&(r=n),x<i&&(i=x),n>t&&(t=n),x>u&&(u=x)}a=0!==(a=Math.max(t-r,u-i))?32767/a:0}return function e(t,n,r,i,a,u,x){if(!t)return;!x&&u&&function(e,t,n,r){let i=e;do 0===i.z&&(i.z=v(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,n=1;do{let r=e,i;e=null;let a=null;for(t=0;r;){t++;let u=r,x=0;for(let e=0;e<n&&(x++,u=u.nextZ);e++);let l=n;for(;x>0||l>0&&u;)0!==x&&(0===l||!u||r.z<=u.z)?(i=r,r=r.nextZ,x--):(i=u,u=u.nextZ,l--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=u}a.nextZ=null,n*=2}while(t>1)}(i)}(t,i,a,u);let l=t;for(;t.prev!==t.next;){let o=t.prev,p=t.next;if(u?function(e,t,n,r){let i=e.prev,a=e.next;if(A(i,e,a)>=0)return!1;let u=i.x,x=e.x,l=a.x,o=i.y,p=e.y,f=a.y,y=Math.min(u,x,l),s=Math.min(o,p,f),h=Math.max(u,x,l),c=Math.max(o,p,f),m=v(y,s,t,n,r),d=v(h,c,t,n,r),g=e.prevZ,S=e.nextZ;for(;g&&g.z>=m&&S&&S.z<=d;){if(g.x>=y&&g.x<=h&&g.y>=s&&g.y<=c&&g!==i&&g!==a&&w(u,o,x,p,l,f,g.x,g.y)&&A(g.prev,g,g.next)>=0||(g=g.prevZ,S.x>=y&&S.x<=h&&S.y>=s&&S.y<=c&&S!==i&&S!==a&&w(u,o,x,p,l,f,S.x,S.y)&&A(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;g&&g.z>=m;){if(g.x>=y&&g.x<=h&&g.y>=s&&g.y<=c&&g!==i&&g!==a&&w(u,o,x,p,l,f,g.x,g.y)&&A(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;S&&S.z<=d;){if(S.x>=y&&S.x<=h&&S.y>=s&&S.y<=c&&S!==i&&S!==a&&w(u,o,x,p,l,f,S.x,S.y)&&A(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}(t,i,a,u):function(e){let t=e.prev,n=e.next;if(A(t,e,n)>=0)return!1;let r=t.x,i=e.x,a=n.x,u=t.y,x=e.y,l=n.y,o=Math.min(r,i,a),p=Math.min(u,x,l),f=Math.max(r,i,a),y=Math.max(u,x,l),s=n.next;for(;s!==t;){if(s.x>=o&&s.x<=f&&s.y>=p&&s.y<=y&&w(r,u,i,x,a,l,s.x,s.y)&&A(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}(t)){n.push(o.i,t.i,p.i),z(t),t=p.next,l=p.next;continue}if((t=p)===l){x?1===x?e(t=function(e,t){let n=e;do{let r=n.prev,i=n.next.next;!S(r,i)&&b(r,n,n.next,i)&&O(r,i)&&O(i,r)&&(t.push(r.i,n.i,i.i),z(n),z(n.next),n=e=i),n=n.next}while(n!==e);return m(n)}(m(t),n),n,r,i,a,u,2):2===x&&function(t,n,r,i,a,u){let x=t;do{let t=x.next.next;for(;t!==x.prev;){var l,o;if(x.i!==t.i&&(l=x,o=t,l.next.i!==o.i&&l.prev.i!==o.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&b(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(l,o)&&(O(l,o)&&O(o,l)&&function(e,t){let n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}(l,o)&&(A(l.prev,l,o.prev)||A(l,o.prev,o))||S(l,o)&&A(l.prev,l,l.next)>0&&A(o.prev,o,o.next)>0))){let l=Z(x,t);x=m(x,x.next),l=m(l,l.next),e(x,n,r,i,a,u,0),e(l,n,r,i,a,u,0);return}t=t.next}x=x.next}while(x!==t)}(t,n,r,i,a,u):e(m(t),n,r,i,a,u,1);break}}}(l,o,n,r,i,a,0),o}(l.packArray(e),t,2)};var L=new u,W=new u,I=new u,$=new u,j=new u,k=new u,K=new u,U=new l,P=new l,N=new l,q=new l;B.computeSubdivision=function(e,a,x,o,s){s=s??p.RADIANS_PER_DEGREE;let h=y(o);f.typeOf.object("ellipsoid",e),f.defined("positions",a),f.defined("indices",x),f.typeOf.number.greaterThanOrEquals("indices.length",x.length,3),f.typeOf.number.equals("indices.length % 3","0",x.length%3,0),f.typeOf.number.greaterThan("granularity",s,0);let c=x.slice(0),m,d=a.length,v=Array(3*d),g=Array(2*d),w=0,A=0;for(m=0;m<d;m++){let e=a[m];if(v[w++]=e.x,v[w++]=e.y,v[w++]=e.z,h){let e=o[m];g[A++]=e.x,g[A++]=e.y}}let S=[],b={},M=e.maximumRadius,E=p.chordLength(s,M),O=E*E;for(;c.length>0;){let e=c.pop(),t=c.pop(),n=c.pop(),r=u.fromArray(v,3*n,L),i=u.fromArray(v,3*t,W),a=u.fromArray(v,3*e,I),x,o,p;h&&(x=l.fromArray(g,2*n,U),o=l.fromArray(g,2*t,P),p=l.fromArray(g,2*e,N));let f=u.multiplyByScalar(u.normalize(r,$),M,$),s=u.multiplyByScalar(u.normalize(i,j),M,j),d=u.multiplyByScalar(u.normalize(a,k),M,k),w=u.magnitudeSquared(u.subtract(f,s,K)),A=u.magnitudeSquared(u.subtract(s,d,K)),E=u.magnitudeSquared(u.subtract(d,f,K)),Z=Math.max(w,A,E),R,z,C;Z>O?w===Z?(y(m=b[R=`${Math.min(n,t)} ${Math.max(n,t)}`])||(z=u.add(r,i,K),u.multiplyByScalar(z,.5,z),v.push(z.x,z.y,z.z),m=v.length/3-1,b[R]=m,h&&(C=l.add(x,o,q),l.multiplyByScalar(C,.5,C),g.push(C.x,C.y))),c.push(n,m,e),c.push(m,t,e)):A===Z?(y(m=b[R=`${Math.min(t,e)} ${Math.max(t,e)}`])||(z=u.add(i,a,K),u.multiplyByScalar(z,.5,z),v.push(z.x,z.y,z.z),m=v.length/3-1,b[R]=m,h&&(C=l.add(o,p,q),l.multiplyByScalar(C,.5,C),g.push(C.x,C.y))),c.push(t,m,n),c.push(m,e,n)):E===Z&&(y(m=b[R=`${Math.min(e,n)} ${Math.max(e,n)}`])||(z=u.add(a,r,K),u.multiplyByScalar(z,.5,z),v.push(z.x,z.y,z.z),m=v.length/3-1,b[R]=m,h&&(C=l.add(p,x,q),l.multiplyByScalar(C,.5,C),g.push(C.x,C.y))),c.push(e,m,t),c.push(m,n,t)):(S.push(n),S.push(t),S.push(e))}let Z={attributes:{position:new r({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:v})},indices:S,primitiveType:t.TRIANGLES};return h&&(Z.attributes.st=new r({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:g})),new n(Z)};var G=new x,F=new x,_=new x,H=new x;B.computeRhumbLineSubdivision=function(a,x,o,s,h){h=h??p.RADIANS_PER_DEGREE;let c=y(s);f.typeOf.object("ellipsoid",a),f.defined("positions",x),f.defined("indices",o),f.typeOf.number.greaterThanOrEquals("indices.length",o.length,3),f.typeOf.number.equals("indices.length % 3","0",o.length%3,0),f.typeOf.number.greaterThan("granularity",h,0);let m=o.slice(0),d,v=x.length,g=Array(3*v),w=Array(2*v),A=0,S=0;for(d=0;d<v;d++){let e=x[d];if(g[A++]=e.x,g[A++]=e.y,g[A++]=e.z,c){let e=s[d];w[S++]=e.x,w[S++]=e.y}}let b=[],M={},E=a.maximumRadius,O=p.chordLength(h,E),Z=new e(void 0,void 0,a),R=new e(void 0,void 0,a),z=new e(void 0,void 0,a);for(;m.length>0;){let e=m.pop(),t=m.pop(),n=m.pop(),r=u.fromArray(g,3*n,L),i=u.fromArray(g,3*t,W),x=u.fromArray(g,3*e,I),o,p,f;c&&(o=l.fromArray(w,2*n,U),p=l.fromArray(w,2*t,P),f=l.fromArray(w,2*e,N));let s=a.cartesianToCartographic(r,G),h=a.cartesianToCartographic(i,F),v=a.cartesianToCartographic(x,_);Z.setEndPoints(s,h);let A=Z.surfaceDistance;R.setEndPoints(h,v);let S=R.surfaceDistance;z.setEndPoints(v,s);let E=z.surfaceDistance,C=Math.max(A,S,E),D,T,B,$,j;C>O?A===C?(y(d=M[D=`${Math.min(n,t)} ${Math.max(n,t)}`])||(T=Z.interpolateUsingFraction(.5,H),B=(s.height+h.height)*.5,$=u.fromRadians(T.longitude,T.latitude,B,a,K),g.push($.x,$.y,$.z),d=g.length/3-1,M[D]=d,c&&(j=l.add(o,p,q),l.multiplyByScalar(j,.5,j),w.push(j.x,j.y))),m.push(n,d,e),m.push(d,t,e)):S===C?(y(d=M[D=`${Math.min(t,e)} ${Math.max(t,e)}`])||(T=R.interpolateUsingFraction(.5,H),B=(h.height+v.height)*.5,$=u.fromRadians(T.longitude,T.latitude,B,a,K),g.push($.x,$.y,$.z),d=g.length/3-1,M[D]=d,c&&(j=l.add(p,f,q),l.multiplyByScalar(j,.5,j),w.push(j.x,j.y))),m.push(t,d,n),m.push(d,e,n)):E===C&&(y(d=M[D=`${Math.min(e,n)} ${Math.max(e,n)}`])||(T=z.interpolateUsingFraction(.5,H),B=(v.height+s.height)*.5,$=u.fromRadians(T.longitude,T.latitude,B,a,K),g.push($.x,$.y,$.z),d=g.length/3-1,M[D]=d,c&&(j=l.add(f,o,q),l.multiplyByScalar(j,.5,j),w.push(j.x,j.y))),m.push(e,d,t),m.push(d,n,t)):(b.push(n),b.push(t),b.push(e))}let C={attributes:{position:new r({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:g})},indices:b,primitiveType:t.TRIANGLES};return c&&(C.attributes.st=new r({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:w})),new n(C)},B.scaleToGeodeticHeight=function(e,t,n,r){n=n??o.default;let i=D,a=T;if(t=t??0,r=r??!0,y(e)){let x=e.length;for(let l=0;l<x;l+=3)u.fromArray(e,l,a),r&&(a=n.scaleToGeodeticSurface(a,a)),0!==t&&(i=n.geodeticSurfaceNormal(a,i),u.multiplyByScalar(i,t,i),u.add(a,i,a)),e[l]=a.x,e[l+1]=a.y,e[l+2]=a.z}return e};var J=B;export{h as a,J as b};