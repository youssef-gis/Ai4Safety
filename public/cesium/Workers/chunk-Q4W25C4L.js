import{a as e}from"./chunk-QORMFUM4.js";import{a as t}from"./chunk-ET7KY3BS.js";import{a as r,b as n,g as o,h as a}from"./chunk-UTYWXSQT.js";import{a as l,b as i,c as c,e as s}from"./chunk-KWAHJ72S.js";import{a as u}from"./chunk-MKDADUG3.js";import{a as d}from"./chunk-NOIUI5SY.js";import{e as g}from"./chunk-XRRBRTKL.js";var m=Object.freeze({ROUNDED:0,MITERED:1,BEVELED:2}),h={};function y(e,t){if(!g(e))throw new d("identifier is required.");g(h[e])||(h[e]=!0,console.warn(t??e))}y.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",y.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored",y.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored",y.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored";var f=y,p=[new l,new l],w=new l,E=new l,x=new l,b=new l,B=new l,S=new l,T=new l,z=new l,A=new l,R=new l,D=new l,P={},v=new i;function O(e,t,r,n){let o=e[0],a=e[1],i=Math.ceil(l.angleBetween(o,a)/n),c=Array(i),s;if(t===r){for(s=0;s<i;s++)c[s]=t;return c.push(r),c}let u=(r-t)/i;for(s=1;s<i;s++){let e=t+s*u;c[s]=e}return c[0]=t,c.push(r),c}var j=new l,I=new l,N=new l(-1,0,0),G=new n,M=new n,U=new s,k=s.IDENTITY.clone(),H=new l,V=new r,L=new l;function q(e,r,o,i,u,d,g,m){var h;let y,f,p,w,E=H,x=V;G=a.eastNorthUpToFixedFrame(e,u,G),E=n.multiplyByPointAsVector(G,N,E);let b=(h=E=l.normalize(E,E),f=(y=new t(e,u)).projectPointOntoPlane(l.add(e,h,j),j),p=y.projectPointOntoPlane(l.add(e,r,I),I),w=c.angleBetween(f,p),p.x*f.y-p.y*f.x>=0?-w:w);U=s.fromRotationZ(b,U),L.z=d,G=n.multiplyTransformation(G,n.fromRotationTranslation(U,L,M),G),k[0]=g;for(let e=0;e<m;e++)for(let e=0;e<o.length;e+=3)x=l.fromArray(o,e,x),x=s.multiplyByVector(k,x,x),x=n.multiplyByPoint(G,x,x),i.push(x.x,x.y,x.z);return i}var F=new l;function K(e,t,r,n,o,a,i){for(let c=0;c<e.length;c+=3)n=q(l.fromArray(e,c,F),t,r,n,o,a[c/3],i,1);return n}function Q(e,t){let r=e.length,n=Array(3*r),o=0,a=t.x+t.width/2,l=t.y+t.height/2;for(let t=0;t<r;t++)n[o++]=e[t].x-a,n[o++]=0,n[o++]=e[t].y-l;return n}var Y=new o,_=new l,W=new s;function X(e,t,r,n,a,i,c,d,g,h){let y,f=l.angleBetween(l.subtract(t,e,R),l.subtract(r,e,D)),p=n===m.BEVELED?0:Math.ceil(f/u.toRadians(5)),w;if(w=a?s.fromQuaternion(o.fromAxisAngle(l.negate(e,R),f/(p+1),Y),W):s.fromQuaternion(o.fromAxisAngle(e,f/(p+1),Y),W),t=l.clone(t,_),p>0){let r=h?2:1;for(let n=0;n<p;n++)t=s.multiplyByVector(w,t,t),y=l.subtract(t,e,R),y=l.normalize(y,y),a||(y=l.negate(y,y)),c=q(i.scaleToGeodeticSurface(t,D),y,d,c,i,g,1,r)}else y=l.subtract(t,e,R),y=l.normalize(y,y),a||(y=l.negate(y,y)),c=q(i.scaleToGeodeticSurface(t,D),y,d,c,i,g,1,1),r=l.clone(r,_),y=l.subtract(r,e,R),y=l.normalize(y,y),a||(y=l.negate(y,y)),c=q(i.scaleToGeodeticSurface(r,D),y,d,c,i,g,1,1);return c}P.removeDuplicatesFromShape=function(e){let t=e.length,r=[];for(let n=t-1,o=0;o<t;n=o++){let t=e[n],a=e[o];c.equals(t,a)||r.push(a)}return r},P.angleIsGreaterThanPi=function(e,r,n,o){let a=new t(n,o),i=a.projectPointOntoPlane(l.add(n,e,j),j),c=a.projectPointOntoPlane(l.add(n,r,I),I);return c.x*i.y-c.y*i.x>=0};var Z=new l,C=new l;P.computePositions=function(t,r,n,o,a){let i,c=o._ellipsoid,s=function(e,t){let r=Array(e.length);for(let n=0;n<e.length;n++){let o=e[n];v=t.cartesianToCartographic(o,v),r[n]=v.height,e[n]=t.scaleToGeodeticSurface(o,o)}return r}(t,c),d=o._granularity,g=o._cornerType,h=a?function(e,t){let r=e.length,n=Array(6*r),o=0,a=t.x+t.width/2,l=t.y+t.height/2,i=e[0];n[o++]=i.x-a,n[o++]=0,n[o++]=i.y-l;for(let t=1;t<r;t++){let r=(i=e[t]).x-a,c=i.y-l;n[o++]=r,n[o++]=0,n[o++]=c,n[o++]=r,n[o++]=0,n[o++]=c}return i=e[0],n[o++]=i.x-a,n[o++]=0,n[o++]=i.y-l,n}(r,n):Q(r,n),y=a?Q(r,n):void 0,D=n.height/2,j=n.width/2,I=t.length,N=[],G=a?[]:void 0,M=w,U=E,k=x,H=b,V=B,L=S,F=T,Y=z,_=A,W=t[0],J=t[1];H=c.geodeticSurfaceNormal(W,H),M=l.subtract(J,W,M),M=l.normalize(M,M),Y=l.cross(H,M,Y),Y=l.normalize(Y,Y);let $=s[0],ee=s[1];a&&(G=q(W,Y,y,G,c,$+D,1,1)),_=l.clone(W,_),W=J,U=l.negate(M,U);for(let r=1;r<I-1;r++){let n=a?2:1;if(J=t[r+1],W.equals(J)){f("Positions are too close and are considered equivalent with rounding error.");continue}M=l.subtract(J,W,M),M=l.normalize(M,M),H=c.geodeticSurfaceNormal(W,H);let o=l.multiplyByScalar(H,l.dot(M,H),Z);l.subtract(M,o,o),l.normalize(o,o);let y=l.multiplyByScalar(H,l.dot(U,H),C);if(l.subtract(U,y,y),l.normalize(y,y),u.equalsEpsilon(Math.abs(l.dot(o,y)),1,u.EPSILON7))N=q(_,Y,h,N,c,$+D,1,1),_=W;else{k=l.add(M,U,k),k=l.normalize(k,k),k=l.cross(k,H,k),k=l.cross(H,k,k),k=l.normalize(k,k);let t=1/Math.max(.25,l.magnitude(l.cross(k,U,R))),r=P.angleIsGreaterThanPi(M,U,W,c);r?(V=l.add(W,l.multiplyByScalar(k,t*j,k),V),L=l.add(V,l.multiplyByScalar(Y,j,L),L),p[0]=l.clone(_,p[0]),p[1]=l.clone(L,p[1]),i=O(p,$+D,ee+D,d),N=K(e.generateArc({positions:p,granularity:d,ellipsoid:c}),Y,h,N,c,i,1),Y=l.cross(H,M,Y),Y=l.normalize(Y,Y),F=l.add(V,l.multiplyByScalar(Y,j,F),F),g===m.ROUNDED||g===m.BEVELED?X(V,L,F,g,r,c,N,h,ee+D,a):N=q(W,k=l.negate(k,k),h,N,c,ee+D,t,n)):(V=l.add(W,l.multiplyByScalar(k,t*j,k),V),L=l.add(V,l.multiplyByScalar(Y,-j,L),L),p[0]=l.clone(_,p[0]),p[1]=l.clone(L,p[1]),i=O(p,$+D,ee+D,d),N=K(e.generateArc({positions:p,granularity:d,ellipsoid:c}),Y,h,N,c,i,1),Y=l.cross(H,M,Y),Y=l.normalize(Y,Y),F=l.add(V,l.multiplyByScalar(Y,-j,F),F),g===m.ROUNDED||g===m.BEVELED?X(V,L,F,g,r,c,N,h,ee+D,a):N=q(W,k,h,N,c,ee+D,t,n)),_=l.clone(F,_),U=l.negate(M,U)}$=ee,ee=s[r+1],W=J}p[0]=l.clone(_,p[0]),p[1]=l.clone(W,p[1]),i=O(p,$+D,ee+D,d),N=K(e.generateArc({positions:p,granularity:d,ellipsoid:c}),Y,h,N,c,i,1),a&&(G=q(W,Y,y,G,c,ee+D,1,1)),I=N.length;let et=new Float64Array(a?I+G.length:I);return et.set(N),a&&et.set(G,I),et};var J=P;export{m as a,f as b,J as c};