import{a as e}from"./chunk-FWF3VNA2.js";import{a as t}from"./chunk-5HPISDSZ.js";import{b as r}from"./chunk-HSJ6GSLC.js";import{a as a}from"./chunk-SXKYZMEL.js";import{b as n}from"./chunk-UTYWXSQT.js";import{a as i,b as o,d as l}from"./chunk-KWAHJ72S.js";import{a as c}from"./chunk-MKDADUG3.js";import{a as s}from"./chunk-NOIUI5SY.js";import{e as u}from"./chunk-XRRBRTKL.js";var h={};h.numberOfPoints=function(e,t,r){return Math.ceil(i.distance(e,t)/r)},h.numberOfPointsRhumbLine=function(e,t,r){return Math.max(1,Math.ceil(Math.sqrt((Math.pow(e.longitude-t.longitude,2)+Math.pow(e.latitude-t.latitude,2))/(r*r))))};var f=new o;h.extractHeights=function(e,t){let r=e.length,a=Array(r);for(let n=0;n<r;n++){let r=e[n];a[n]=t.cartesianToCartographic(r,f).height}return a};var g=new n,p=new i,m=new i,d=new a(i.UNIT_X,0),T=new i,w=new a(i.UNIT_X,0),y=new i,A=new i,S=[];function P(e,t,r){let a;if(S.length=e,t===r){for(a=0;a<e;a++)S[a]=t;return S}let n=(r-t)/e;for(a=0;a<e;a++){let e=t+a*n;S[a]=e}return S}var C=new o,k=new o,R=new i,D=new i,b=new i,E=new e,N=new t;h.wrapLongitude=function(e,t){let o=[],l=[];if(u(e)&&e.length>0){t=t??n.IDENTITY;let c=n.inverseTransformation(t,g),s=n.multiplyByPoint(c,i.ZERO,p),h=i.normalize(n.multiplyByPointAsVector(c,i.UNIT_Y,m),m),f=a.fromPointNormal(s,h,d),S=i.normalize(n.multiplyByPointAsVector(c,i.UNIT_X,T),T),P=a.fromPointNormal(s,S,w),C=1;o.push(i.clone(e[0]));let k=o[0],R=e.length;for(let t=1;t<R;++t){let n=e[t];if(0>a.getPointDistance(P,k)||0>a.getPointDistance(P,n)){let e=r.lineSegmentPlane(k,n,f,y);if(u(e)){let t=i.multiplyByScalar(h,5e-9,A);0>a.getPointDistance(f,k)&&i.negate(t,t),o.push(i.add(e,t,new i)),l.push(C+1),i.negate(t,t),o.push(i.add(e,t,new i)),C=1}}o.push(i.clone(e[t])),C++,k=n}l.push(C)}return{positions:o,lengths:l}},h.generateArc=function(e){u(e)||(e={});let t=e.positions;if(!u(t))throw new s("options.positions is required.");let r=t.length,a=e.ellipsoid??l.default,n=e.height??0,o=Array.isArray(n);if(r<1)return[];if(1===r){let e=a.scaleToGeodeticSurface(t[0],D);if(0!==(n=o?n[0]:n)){let t=a.geodeticSurfaceNormal(e,R);i.multiplyByScalar(t,n,t),i.add(e,t,e)}return[e.x,e.y,e.z]}let f=e.minDistance;if(!u(f)){let t=e.granularity??c.RADIANS_PER_DEGREE;f=c.chordLength(t,a.maximumRadius)}let g=0,p;for(p=0;p<r-1;p++)g+=h.numberOfPoints(t[p],t[p+1],f);let m=(g+1)*3,d=Array(m),T=0;for(p=0;p<r-1;p++)T=function(e,t,r,a,n,o,l,c){let s=a.scaleToGeodeticSurface(e,D),u=a.scaleToGeodeticSurface(t,b),f=h.numberOfPoints(e,t,r),g=a.cartesianToCartographic(s,C),p=a.cartesianToCartographic(u,k),m=P(f,n,o);E.setEndPoints(g,p);let d=E.surfaceDistance/f,T=c;g.height=n;let w=a.cartographicToCartesian(g,R);i.pack(w,l,T),T+=3;for(let e=1;e<f;e++){let t=E.interpolateUsingSurfaceDistance(e*d,k);t.height=m[e],w=a.cartographicToCartesian(t,R),i.pack(w,l,T),T+=3}return T}(t[p],t[p+1],f,a,o?n[p]:n,o?n[p+1]:n,d,T);S.length=0;let w=t[r-1],y=a.cartesianToCartographic(w,C);y.height=o?n[r-1]:n;let A=a.cartographicToCartesian(y,R);return i.pack(A,d,m-3),d};var I=new o,j=new o;h.generateRhumbArc=function(e){u(e)||(e={});let r=e.positions;if(!u(r))throw new s("options.positions is required.");let a=r.length,n=e.ellipsoid??l.default,f=e.height??0,g=Array.isArray(f);if(a<1)return[];if(1===a){let e=n.scaleToGeodeticSurface(r[0],D);if(0!==(f=g?f[0]:f)){let t=n.geodeticSurfaceNormal(e,R);i.multiplyByScalar(t,f,t),i.add(e,t,e)}return[e.x,e.y,e.z]}let p=e.granularity??c.RADIANS_PER_DEGREE,m=0,d,T=n.cartesianToCartographic(r[0],I),w;for(d=0;d<a-1;d++)w=n.cartesianToCartographic(r[d+1],j),m+=h.numberOfPointsRhumbLine(T,w,p),T=o.clone(w,I);let y=(m+1)*3,A=Array(y),b=0;for(d=0;d<a-1;d++)b=function(e,r,a,n,o,l,c,s){let u=n.cartesianToCartographic(e,C),f=n.cartesianToCartographic(r,k),g=h.numberOfPointsRhumbLine(u,f,a);u.height=0,f.height=0;let p=P(g,o,l);N.ellipsoid.equals(n)||(N=new t(void 0,void 0,n)),N.setEndPoints(u,f);let m=N.surfaceDistance/g,d=s;u.height=o;let T=n.cartographicToCartesian(u,R);i.pack(T,c,d),d+=3;for(let e=1;e<g;e++){let t=N.interpolateUsingSurfaceDistance(e*m,k);t.height=p[e],T=n.cartographicToCartesian(t,R),i.pack(T,c,d),d+=3}return d}(r[d],r[d+1],p,n,g?f[d]:f,g?f[d+1]:f,A,b);S.length=0;let E=r[a-1],v=n.cartesianToCartographic(E,C);v.height=g?f[a-1]:f;let U=n.cartographicToCartesian(v,R);return i.pack(U,A,y-3),A},h.generateCartesianArc=function(e){let t=h.generateArc(e),r=t.length/3,a=Array(r);for(let e=0;e<r;e++)a[e]=i.unpack(t,3*e);return a},h.generateCartesianRhumbArc=function(e){let t=h.generateRhumbArc(e),r=t.length/3,a=Array(r);for(let e=0;e<r;e++)a[e]=i.unpack(t,3*e);return a};var v=h;export{v as a};