import{a as e}from"./chunk-ET7KY3BS.js";import{a as t}from"./chunk-SXKYZMEL.js";import{b as n,c as a,d as r}from"./chunk-XQIJGAVD.js";import{b as o,i as i}from"./chunk-UTYWXSQT.js";import{a as s,b as c,c as u,d as l,e as d}from"./chunk-KWAHJ72S.js";import{a as h}from"./chunk-MKDADUG3.js";import{a as m,b as f}from"./chunk-NOIUI5SY.js";import{e as w}from"./chunk-XRRBRTKL.js";function p(e,t){this.center=s.clone(e??s.ZERO),this.halfAxes=d.clone(t??d.ZERO)}p.packedLength=s.packedLength+d.packedLength,p.pack=function(e,t,n){return f.typeOf.object("value",e),f.defined("array",t),n=n??0,s.pack(e.center,t,n),d.pack(e.halfAxes,t,n+s.packedLength),t},p.unpack=function(e,t,n){return f.defined("array",e),t=t??0,w(n)||(n=new p),s.unpack(e,t,n.center),d.unpack(e,t+s.packedLength,n.halfAxes),n};var x=new s,b=new s,y=new s,g=new s,M=new s,O=new s,A=new d,T={unitary:new d,diagonal:new d};p.fromPoints=function(e,t){if(w(t)||(t=new p),!w(e)||0===e.length)return t.halfAxes=d.ZERO,t.center=s.ZERO,t;let n,a=e.length,r=s.clone(e[0],x);for(n=1;n<a;n++)s.add(r,e[n],r);let o=1/a;s.multiplyByScalar(r,o,r);let i=0,c=0,u=0,l=0,h=0,m=0,f;for(n=0;n<a;n++)i+=(f=s.subtract(e[n],r,b)).x*f.x,c+=f.x*f.y,u+=f.x*f.z,l+=f.y*f.y,h+=f.y*f.z,m+=f.z*f.z;i*=o,c*=o,u*=o,l*=o,h*=o,m*=o,A[0]=i,A[1]=c,A[2]=u,A[3]=c,A[4]=l,A[5]=h,A[6]=u,A[7]=h,A[8]=m;let N=d.computeEigenDecomposition(A,T),C=d.clone(N.unitary,t.halfAxes),P=d.getColumn(C,0,g),R=d.getColumn(C,1,M),S=d.getColumn(C,2,O),U=-Number.MAX_VALUE,L=-Number.MAX_VALUE,E=-Number.MAX_VALUE,I=Number.MAX_VALUE,q=Number.MAX_VALUE,z=Number.MAX_VALUE;for(n=0;n<a;n++)f=e[n],U=Math.max(s.dot(P,f),U),L=Math.max(s.dot(R,f),L),E=Math.max(s.dot(S,f),E),I=Math.min(s.dot(P,f),I),q=Math.min(s.dot(R,f),q),z=Math.min(s.dot(S,f),z);P=s.multiplyByScalar(P,.5*(I+U),P),R=s.multiplyByScalar(R,.5*(q+L),R),S=s.multiplyByScalar(S,.5*(z+E),S);let k=s.add(P,R,t.center);return s.add(k,S,k),y.x=U-I,y.y=L-q,y.z=E-z,s.multiplyByScalar(y,.5,y),d.multiplyByScale(t.halfAxes,y,t.halfAxes),t};var N=new s,C=new s;function P(e,t,n,a,r,o,i,c,u,l,h){if(!w(r)||!w(o)||!w(i)||!w(c)||!w(u)||!w(l))throw new m("all extents (minimum/maximum X/Y/Z) are required.");w(h)||(h=new p);let f=h.halfAxes;d.setColumn(f,0,t,f),d.setColumn(f,1,n,f),d.setColumn(f,2,a,f);let x=N;x.x=(r+o)/2,x.y=(i+c)/2,x.z=(u+l)/2,C.x=(o-r)/2,C.y=(c-i)/2,C.z=(l-u)/2;let b=h.center;return x=d.multiplyByVector(f,x,x),s.add(e,x,b),d.multiplyByScale(f,C,f),h}var R=new c,S=new s,U=new c,L=new c,E=new c,I=new c,q=new c,z=new s,k=new s,j=new s,B=new s,_=new s,X=new u,v=new u,W=new u,D=new u,V=new u,Z=new s,Y=new s,K=new s,G=new s,J=new u,Q=new s,H=new s,F=new s,$=new t(s.UNIT_X,0);p.fromRectangle=function(n,a,r,o,u){let d,f,p,x,b,y,g;if(!w(n))throw new m("rectangle is required");if(n.width<0||n.width>h.TWO_PI)throw new m("Rectangle width must be between 0 and 2 * pi");if(n.height<0||n.height>h.PI)throw new m("Rectangle height must be between 0 and pi");if(w(o)&&!h.equalsEpsilon(o.radii.x,o.radii.y,h.EPSILON15))throw new m("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");if(a=a??0,r=r??0,o=o??l.default,n.width<=h.PI){let s=i.center(n,R),l=new e(o.cartographicToCartesian(s,S),o);g=l.plane;let h=s.longitude,m=n.south<0&&n.north>0?0:s.latitude,w=c.fromRadians(h,n.north,r,U),M=c.fromRadians(n.west,n.north,r,L),O=c.fromRadians(n.west,m,r,E),A=c.fromRadians(n.west,n.south,r,I),T=c.fromRadians(h,n.south,r,q),N=o.cartographicToCartesian(w,z),C=o.cartographicToCartesian(M,k),Z=o.cartographicToCartesian(O,j),Y=o.cartographicToCartesian(A,B),K=o.cartographicToCartesian(T,_),G=l.projectPointToNearestOnPlane(N,X),J=l.projectPointToNearestOnPlane(C,v),Q=l.projectPointToNearestOnPlane(Z,W),H=l.projectPointToNearestOnPlane(Y,D),F=l.projectPointToNearestOnPlane(K,V);return f=-(d=Math.min(J.x,Q.x,H.x)),x=Math.max(J.y,G.y),p=Math.min(H.y,F.y),M.height=A.height=a,C=o.cartographicToCartesian(M,k),Y=o.cartographicToCartesian(A,B),b=Math.min(t.getPointDistance(g,C),t.getPointDistance(g,Y)),y=r,P(l.origin,l.xAxis,l.yAxis,l.zAxis,d,f,p,x,b,y,u)}let M=n.south>0,O=n.north<0,A=M?n.south:O?n.north:0,T=i.center(n,R).longitude,N=s.fromRadians(T,A,r,o,Z);N.z=0;let C=Math.abs(N.x)<h.EPSILON10&&Math.abs(N.y)<h.EPSILON10?s.UNIT_X:s.normalize(N,Y),ee=s.UNIT_Z,et=s.cross(C,ee,K);g=t.fromPointNormal(N,C,$);let en=s.fromRadians(T+h.PI_OVER_TWO,A,r,o,G);d=-(f=s.dot(t.projectPointOntoPlane(g,en,J),et)),x=s.fromRadians(0,n.north,O?a:r,o,Q).z,p=s.fromRadians(0,n.south,M?a:r,o,H).z;let ea=s.fromRadians(n.east,A,r,o,F);return P(N,et,ee,C,d,f,p,x,b=t.getPointDistance(g,ea),y=0,u)},p.fromTransformation=function(e,t){return f.typeOf.object("transformation",e),w(t)||(t=new p),t.center=o.getTranslation(e,t.center),t.halfAxes=o.getMatrix3(e,t.halfAxes),t.halfAxes=d.multiplyByScalar(t.halfAxes,.5,t.halfAxes),t},p.clone=function(e,t){if(w(e))return w(t)?(s.clone(e.center,t.center),d.clone(e.halfAxes,t.halfAxes),t):new p(e.center,e.halfAxes)},p.intersectPlane=function(e,t){if(!w(e))throw new m("box is required.");if(!w(t))throw new m("plane is required.");let a=e.center,r=t.normal,o=e.halfAxes,i=r.x,c=r.y,u=r.z,l=Math.abs(i*o[d.COLUMN0ROW0]+c*o[d.COLUMN0ROW1]+u*o[d.COLUMN0ROW2])+Math.abs(i*o[d.COLUMN1ROW0]+c*o[d.COLUMN1ROW1]+u*o[d.COLUMN1ROW2])+Math.abs(i*o[d.COLUMN2ROW0]+c*o[d.COLUMN2ROW1]+u*o[d.COLUMN2ROW2]),h=s.dot(r,a)+t.distance;return h<=-l?n.OUTSIDE:h>=l?n.INSIDE:n.INTERSECTING};var ee=new s,et=new s,en=new s,ea=new s,er=new s,eo=new s;p.distanceSquaredTo=function(e,t){if(!w(e))throw new m("box is required.");if(!w(t))throw new m("cartesian is required.");let n=s.subtract(t,e.center,N),a=e.halfAxes,r=d.getColumn(a,0,ee),o=d.getColumn(a,1,et),i=d.getColumn(a,2,en),c=s.magnitude(r),u=s.magnitude(o),l=s.magnitude(i),f=!0,p=!0,x=!0;c>0?s.divideByScalar(r,c,r):f=!1,u>0?s.divideByScalar(o,u,o):p=!1,l>0?s.divideByScalar(i,l,i):x=!1;let b=!f+!p+!x,y,g,M;if(1===b){let e=r;y=o,g=i,p?x||(e=i,g=r):(e=o,y=r),M=s.cross(y,g,er),e===r?r=M:e===o?o=M:e===i&&(i=M)}else if(2===b){y=r,p?y=o:x&&(y=i);let e=s.UNIT_Y;e.equalsEpsilon(y,h.EPSILON3)&&(e=s.UNIT_X),g=s.cross(y,e,ea),s.normalize(g,g),M=s.cross(y,g,er),s.normalize(M,M),y===r?(o=g,i=M):y===o?(i=g,r=M):y===i&&(r=g,o=M)}else 3===b&&(r=s.UNIT_X,o=s.UNIT_Y,i=s.UNIT_Z);eo.x=s.dot(n,r),eo.y=s.dot(n,o),eo.z=s.dot(n,i);let O=0,A;return eo.x<-c?O+=(A=eo.x+c)*A:eo.x>c&&(O+=(A=eo.x-c)*A),eo.y<-u?O+=(A=eo.y+u)*A:eo.y>u&&(O+=(A=eo.y-u)*A),eo.z<-l?O+=(A=eo.z+l)*A:eo.z>l&&(O+=(A=eo.z-l)*A),O};var ei=new s,es=new s;p.computePlaneDistances=function(e,t,n,r){if(!w(e))throw new m("box is required.");if(!w(t))throw new m("position is required.");if(!w(n))throw new m("direction is required.");w(r)||(r=new a);let o=1/0,i=-1/0,c=e.center,u=e.halfAxes,l=d.getColumn(u,0,ee),h=d.getColumn(u,1,et),f=d.getColumn(u,2,en),p=s.add(l,h,ei);s.add(p,f,p),s.add(p,c,p);let x=s.subtract(p,t,es),b=s.dot(n,x);return o=Math.min(b,o),i=Math.max(b,i),s.add(c,l,p),s.add(p,h,p),s.subtract(p,f,p),s.subtract(p,t,x),o=Math.min(b=s.dot(n,x),o),i=Math.max(b,i),s.add(c,l,p),s.subtract(p,h,p),s.add(p,f,p),s.subtract(p,t,x),o=Math.min(b=s.dot(n,x),o),i=Math.max(b,i),s.add(c,l,p),s.subtract(p,h,p),s.subtract(p,f,p),s.subtract(p,t,x),o=Math.min(b=s.dot(n,x),o),i=Math.max(b,i),s.subtract(c,l,p),s.add(p,h,p),s.add(p,f,p),s.subtract(p,t,x),o=Math.min(b=s.dot(n,x),o),i=Math.max(b,i),s.subtract(c,l,p),s.add(p,h,p),s.subtract(p,f,p),s.subtract(p,t,x),o=Math.min(b=s.dot(n,x),o),i=Math.max(b,i),s.subtract(c,l,p),s.subtract(p,h,p),s.add(p,f,p),s.subtract(p,t,x),o=Math.min(b=s.dot(n,x),o),i=Math.max(b,i),s.subtract(c,l,p),s.subtract(p,h,p),s.subtract(p,f,p),s.subtract(p,t,x),o=Math.min(b=s.dot(n,x),o),i=Math.max(b,i),r.start=o,r.stop=i,r};var ec=new s,eu=new s,el=new s;p.computeCorners=function(e,t){f.typeOf.object("box",e),w(t)||(t=[new s,new s,new s,new s,new s,new s,new s,new s]);let n=e.center,a=e.halfAxes,r=d.getColumn(a,0,ec),o=d.getColumn(a,1,eu),i=d.getColumn(a,2,el);return s.clone(n,t[0]),s.subtract(t[0],r,t[0]),s.subtract(t[0],o,t[0]),s.subtract(t[0],i,t[0]),s.clone(n,t[1]),s.subtract(t[1],r,t[1]),s.subtract(t[1],o,t[1]),s.add(t[1],i,t[1]),s.clone(n,t[2]),s.subtract(t[2],r,t[2]),s.add(t[2],o,t[2]),s.subtract(t[2],i,t[2]),s.clone(n,t[3]),s.subtract(t[3],r,t[3]),s.add(t[3],o,t[3]),s.add(t[3],i,t[3]),s.clone(n,t[4]),s.add(t[4],r,t[4]),s.subtract(t[4],o,t[4]),s.subtract(t[4],i,t[4]),s.clone(n,t[5]),s.add(t[5],r,t[5]),s.subtract(t[5],o,t[5]),s.add(t[5],i,t[5]),s.clone(n,t[6]),s.add(t[6],r,t[6]),s.add(t[6],o,t[6]),s.subtract(t[6],i,t[6]),s.clone(n,t[7]),s.add(t[7],r,t[7]),s.add(t[7],o,t[7]),s.add(t[7],i,t[7]),t};var ed=new d;p.computeTransformation=function(e,t){f.typeOf.object("box",e),w(t)||(t=new o);let n=e.center,a=d.multiplyByUniformScale(e.halfAxes,2,ed);return o.fromRotationTranslation(a,n,t)};var eh=new r;p.isOccluded=function(e,t){if(!w(e))throw new m("box is required.");if(!w(t))throw new m("occluder is required.");let n=r.fromOrientedBoundingBox(e,eh);return!t.isBoundingSphereVisible(n)},p.prototype.intersectPlane=function(e){return p.intersectPlane(this,e)},p.prototype.distanceSquaredTo=function(e){return p.distanceSquaredTo(this,e)},p.prototype.computePlaneDistances=function(e,t,n){return p.computePlaneDistances(this,e,t,n)},p.prototype.computeCorners=function(e){return p.computeCorners(this,e)},p.prototype.computeTransformation=function(e){return p.computeTransformation(this,e)},p.prototype.isOccluded=function(e){return p.isOccluded(this,e)},p.equals=function(e,t){return e===t||w(e)&&w(t)&&s.equals(e.center,t.center)&&d.equals(e.halfAxes,t.halfAxes)},p.prototype.clone=function(e){return p.clone(this,e)},p.prototype.equals=function(e){return p.equals(this,e)};var em=p;export{em as a};