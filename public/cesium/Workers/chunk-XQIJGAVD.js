import{b as e,i as t}from"./chunk-UTYWXSQT.js";import{a as n,b as r,d as o,e as a}from"./chunk-KWAHJ72S.js";import{a as c}from"./chunk-MKDADUG3.js";import{a as i,b as u}from"./chunk-NOIUI5SY.js";import{e as l}from"./chunk-XRRBRTKL.js";function s(e){this._ellipsoid=e??o.default,this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(s.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),s.prototype.project=function(e,t){let r=this._semimajorAxis,o=e.longitude*r,a=e.latitude*r,c=e.height;return l(t)?(t.x=o,t.y=a,t.z=c,t):new n(o,a,c)},s.prototype.unproject=function(e,t){if(!l(e))throw new i("cartesian is required");let n=this._oneOverSemimajorAxis,o=e.x*n,a=e.y*n,c=e.z;return l(t)?(t.longitude=o,t.latitude=a,t.height=c,t):new r(o,a,c)};var d=s,f=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1}),y=function(e,t){this.start=e??0,this.stop=t??0};function p(e,t){this.center=n.clone(e??n.ZERO),this.radius=t??0}var m=new n,h=new n,x=new n,g=new n,z=new n,w=new n,b=new n,O=new n,j=new n,S=new n,q=new n,E=new n,R=4/3*c.PI;p.fromPoints=function(e,t){if(l(t)||(t=new p),!l(e)||0===e.length)return t.center=n.clone(n.ZERO,t.center),t.radius=0,t;let r=n.clone(e[0],b),o=n.clone(r,m),a=n.clone(r,h),c=n.clone(r,x),i=n.clone(r,g),u=n.clone(r,z),s=n.clone(r,w),d=e.length,f;for(f=1;f<d;f++){n.clone(e[f],r);let t=r.x,l=r.y,d=r.z;t<o.x&&n.clone(r,o),t>i.x&&n.clone(r,i),l<a.y&&n.clone(r,a),l>u.y&&n.clone(r,u),d<c.z&&n.clone(r,c),d>s.z&&n.clone(r,s)}let y=n.magnitudeSquared(n.subtract(i,o,O)),R=n.magnitudeSquared(n.subtract(u,a,O)),T=n.magnitudeSquared(n.subtract(s,c,O)),v=o,I=i,P=y;R>P&&(P=R,v=a,I=u),T>P&&(P=T,v=c,I=s),j.x=(v.x+I.x)*.5,j.y=(v.y+I.y)*.5,j.z=(v.z+I.z)*.5;let D=n.magnitudeSquared(n.subtract(I,j,O)),B=Math.sqrt(D);S.x=o.x,S.y=a.y,S.z=c.z,q.x=i.x,q.y=u.y,q.z=s.z;let _=n.midpoint(S,q,E),Z=0;for(f=0;f<d;f++){n.clone(e[f],r);let t=n.magnitude(n.subtract(r,_,O));t>Z&&(Z=t);let o=n.magnitudeSquared(n.subtract(r,j,O));if(o>D){let e=Math.sqrt(o);D=(B=(B+e)*.5)*B;let t=e-B;j.x=(B*j.x+t*r.x)/e,j.y=(B*j.y+t*r.y)/e,j.z=(B*j.z+t*r.z)/e}}return B<Z?(n.clone(j,t.center),t.radius=B):(n.clone(_,t.center),t.radius=Z),t};var T=new d,v=new n,I=new n,P=new r,D=new r;p.fromRectangle2D=function(e,t,n){return p.fromRectangleWithHeights2D(e,t,0,0,n)},p.fromRectangleWithHeights2D=function(e,r,a,c,i){if(l(i)||(i=new p),!l(e))return i.center=n.clone(n.ZERO,i.center),i.radius=0,i;T._ellipsoid=o.default,r=r??T,t.southwest(e,P),P.height=a,t.northeast(e,D),D.height=c;let u=r.project(P,v),s=r.project(D,I),d=s.x-u.x,f=s.y-u.y,y=s.z-u.z;i.radius=.5*Math.sqrt(d*d+f*f+y*y);let m=i.center;return m.x=u.x+.5*d,m.y=u.y+.5*f,m.z=u.z+.5*y,i};var B=[];p.fromRectangle3D=function(e,r,a,c){if(r=r??o.default,a=a??0,l(c)||(c=new p),!l(e))return c.center=n.clone(n.ZERO,c.center),c.radius=0,c;let i=t.subsample(e,r,a,B);return p.fromPoints(i,c)},p.fromVertices=function(e,t,r,o){if(l(o)||(o=new p),!l(e)||0===e.length)return o.center=n.clone(n.ZERO,o.center),o.radius=0,o;t=t??n.ZERO,r=r??3,u.typeOf.number.greaterThanOrEquals("stride",r,3),b.x=e[0]+t.x,b.y=e[1]+t.y,b.z=e[2]+t.z;let a=n.clone(b,m),c=n.clone(b,h),i=n.clone(b,x),s=n.clone(b,g),d=n.clone(b,z),f=n.clone(b,w),y=e.length,R;for(R=0;R<y;R+=r){let r=e[R]+t.x,o=e[R+1]+t.y,u=e[R+2]+t.z;b.x=r,b.y=o,b.z=u,r<a.x&&n.clone(b,a),r>s.x&&n.clone(b,s),o<c.y&&n.clone(b,c),o>d.y&&n.clone(b,d),u<i.z&&n.clone(b,i),u>f.z&&n.clone(b,f)}let T=n.magnitudeSquared(n.subtract(s,a,O)),v=n.magnitudeSquared(n.subtract(d,c,O)),I=n.magnitudeSquared(n.subtract(f,i,O)),P=a,D=s,B=T;v>B&&(B=v,P=c,D=d),I>B&&(B=I,P=i,D=f),j.x=(P.x+D.x)*.5,j.y=(P.y+D.y)*.5,j.z=(P.z+D.z)*.5;let _=n.magnitudeSquared(n.subtract(D,j,O)),Z=Math.sqrt(_);S.x=a.x,S.y=c.y,S.z=i.z,q.x=s.x,q.y=d.y,q.z=f.z;let M=n.midpoint(S,q,E),N=0;for(R=0;R<y;R+=r){b.x=e[R]+t.x,b.y=e[R+1]+t.y,b.z=e[R+2]+t.z;let r=n.magnitude(n.subtract(b,M,O));r>N&&(N=r);let o=n.magnitudeSquared(n.subtract(b,j,O));if(o>_){let e=Math.sqrt(o);_=(Z=(Z+e)*.5)*Z;let t=e-Z;j.x=(Z*j.x+t*b.x)/e,j.y=(Z*j.y+t*b.y)/e,j.z=(Z*j.z+t*b.z)/e}}return Z<N?(n.clone(j,o.center),o.radius=Z):(n.clone(M,o.center),o.radius=N),o},p.fromEncodedCartesianVertices=function(e,t,r){if(l(r)||(r=new p),!l(e)||!l(t)||e.length!==t.length||0===e.length)return r.center=n.clone(n.ZERO,r.center),r.radius=0,r;b.x=e[0]+t[0],b.y=e[1]+t[1],b.z=e[2]+t[2];let o=n.clone(b,m),a=n.clone(b,h),c=n.clone(b,x),i=n.clone(b,g),u=n.clone(b,z),s=n.clone(b,w),d=e.length,f;for(f=0;f<d;f+=3){let r=e[f]+t[f],l=e[f+1]+t[f+1],d=e[f+2]+t[f+2];b.x=r,b.y=l,b.z=d,r<o.x&&n.clone(b,o),r>i.x&&n.clone(b,i),l<a.y&&n.clone(b,a),l>u.y&&n.clone(b,u),d<c.z&&n.clone(b,c),d>s.z&&n.clone(b,s)}let y=n.magnitudeSquared(n.subtract(i,o,O)),R=n.magnitudeSquared(n.subtract(u,a,O)),T=n.magnitudeSquared(n.subtract(s,c,O)),v=o,I=i,P=y;R>P&&(P=R,v=a,I=u),T>P&&(P=T,v=c,I=s),j.x=(v.x+I.x)*.5,j.y=(v.y+I.y)*.5,j.z=(v.z+I.z)*.5;let D=n.magnitudeSquared(n.subtract(I,j,O)),B=Math.sqrt(D);S.x=o.x,S.y=a.y,S.z=c.z,q.x=i.x,q.y=u.y,q.z=s.z;let _=n.midpoint(S,q,E),Z=0;for(f=0;f<d;f+=3){b.x=e[f]+t[f],b.y=e[f+1]+t[f+1],b.z=e[f+2]+t[f+2];let r=n.magnitude(n.subtract(b,_,O));r>Z&&(Z=r);let o=n.magnitudeSquared(n.subtract(b,j,O));if(o>D){let e=Math.sqrt(o);D=(B=(B+e)*.5)*B;let t=e-B;j.x=(B*j.x+t*b.x)/e,j.y=(B*j.y+t*b.y)/e,j.z=(B*j.z+t*b.z)/e}}return B<Z?(n.clone(j,r.center),r.radius=B):(n.clone(_,r.center),r.radius=Z),r},p.fromCornerPoints=function(e,t,r){u.typeOf.object("corner",e),u.typeOf.object("oppositeCorner",t),l(r)||(r=new p);let o=n.midpoint(e,t,r.center);return r.radius=n.distance(o,t),r},p.fromEllipsoid=function(e,t){return u.typeOf.object("ellipsoid",e),l(t)||(t=new p),n.clone(n.ZERO,t.center),t.radius=e.maximumRadius,t};var _=new n;p.fromBoundingSpheres=function(e,t){if(l(t)||(t=new p),!l(e)||0===e.length)return t.center=n.clone(n.ZERO,t.center),t.radius=0,t;let r=e.length;if(1===r)return p.clone(e[0],t);if(2===r)return p.union(e[0],e[1],t);let o=[],a;for(a=0;a<r;a++)o.push(e[a].center);let c=(t=p.fromPoints(o,t)).center,i=t.radius;for(a=0;a<r;a++){let t=e[a];i=Math.max(i,n.distance(c,t.center,_)+t.radius)}return t.radius=i,t};var Z=new n,M=new n,N=new n;p.fromOrientedBoundingBox=function(e,t){u.defined("orientedBoundingBox",e),l(t)||(t=new p);let r=e.halfAxes,o=a.getColumn(r,0,Z),c=a.getColumn(r,1,M),i=a.getColumn(r,2,N);return n.add(o,c,o),n.add(o,i,o),t.center=n.clone(e.center,t.center),t.radius=n.magnitude(o),t};var k=new n,A=new n;p.fromTransformation=function(t,r){u.typeOf.object("transformation",t),l(r)||(r=new p);let o=e.getTranslation(t,k),a=e.getScale(t,A),c=.5*n.magnitude(a);return r.center=n.clone(o,r.center),r.radius=c,r},p.clone=function(e,t){if(l(e))return l(t)?(t.center=n.clone(e.center,t.center),t.radius=e.radius,t):new p(e.center,e.radius)},p.packedLength=4,p.pack=function(e,t,n){u.typeOf.object("value",e),u.defined("array",t),n=n??0;let r=e.center;return t[n++]=r.x,t[n++]=r.y,t[n++]=r.z,t[n]=e.radius,t},p.unpack=function(e,t,n){u.defined("array",e),t=t??0,l(n)||(n=new p);let r=n.center;return r.x=e[t++],r.y=e[t++],r.z=e[t++],n.radius=e[t],n};var C=new n,U=new n;p.union=function(e,t,r){u.typeOf.object("left",e),u.typeOf.object("right",t),l(r)||(r=new p);let o=e.center,a=e.radius,c=t.center,i=t.radius,s=n.subtract(c,o,C),d=n.magnitude(s);if(a>=d+i)return e.clone(r),r;if(i>=d+a)return t.clone(r),r;let f=(a+d+i)*.5,y=n.multiplyByScalar(s,(-a+f)/d,U);return n.add(y,o,y),n.clone(y,r.center),r.radius=f,r};var W=new n;p.expand=function(e,t,r){u.typeOf.object("sphere",e),u.typeOf.object("point",t),r=p.clone(e,r);let o=n.magnitude(n.subtract(t,r.center,W));return o>r.radius&&(r.radius=o),r},p.intersectPlane=function(e,t){u.typeOf.object("sphere",e),u.typeOf.object("plane",t);let r=e.center,o=e.radius,a=t.normal,c=n.dot(a,r)+t.distance;return c<-o?f.OUTSIDE:c<o?f.INTERSECTING:f.INSIDE},p.transform=function(t,n,r){return u.typeOf.object("sphere",t),u.typeOf.object("transform",n),l(r)||(r=new p),r.center=e.multiplyByPoint(n,t.center,r.center),r.radius=e.getMaximumScale(n)*t.radius,r};var G=new n;p.distanceSquaredTo=function(e,t){u.typeOf.object("sphere",e),u.typeOf.object("cartesian",t);let r=n.subtract(e.center,t,G),o=n.magnitude(r)-e.radius;return o<=0?0:o*o},p.transformWithoutScale=function(t,n,r){return u.typeOf.object("sphere",t),u.typeOf.object("transform",n),l(r)||(r=new p),r.center=e.multiplyByPoint(n,t.center,r.center),r.radius=t.radius,r};var H=new n;p.computePlaneDistances=function(e,t,r,o){u.typeOf.object("sphere",e),u.typeOf.object("position",t),u.typeOf.object("direction",r),l(o)||(o=new y);let a=n.subtract(e.center,t,H),c=n.dot(r,a);return o.start=c-e.radius,o.stop=c+e.radius,o};var K=new n,L=new n,V=new n,X=new n,Y=new n,J=new r,Q=Array(8);for(let e=0;e<8;++e)Q[e]=new n;var F=new d;p.projectTo2D=function(e,t,r){u.typeOf.object("sphere",e),F._ellipsoid=o.default;let a=(t=t??F).ellipsoid,c=e.center,i=e.radius,l;l=n.equals(c,n.ZERO)?n.clone(n.UNIT_X,K):a.geodeticSurfaceNormal(c,K);let s=n.cross(n.UNIT_Z,l,L);n.normalize(s,s);let d=n.cross(l,s,V);n.normalize(d,d),n.multiplyByScalar(l,i,l),n.multiplyByScalar(d,i,d),n.multiplyByScalar(s,i,s);let f=n.negate(d,Y),y=n.negate(s,X),m=Q[0];n.add(l,d,m),n.add(m,s,m),m=Q[1],n.add(l,d,m),n.add(m,y,m),m=Q[2],n.add(l,f,m),n.add(m,y,m),m=Q[3],n.add(l,f,m),n.add(m,s,m),n.negate(l,l),m=Q[4],n.add(l,d,m),n.add(m,s,m),m=Q[5],n.add(l,d,m),n.add(m,y,m),m=Q[6],n.add(l,f,m),n.add(m,y,m),m=Q[7],n.add(l,f,m),n.add(m,s,m);let h=Q.length;for(let e=0;e<h;++e){let r=Q[e];n.add(c,r,r);let o=a.cartesianToCartographic(r,J);t.project(o,r)}let x=(c=(r=p.fromPoints(Q,r)).center).x,g=c.y,z=c.z;return c.x=z,c.y=x,c.z=g,r},p.isOccluded=function(e,t){return u.typeOf.object("sphere",e),u.typeOf.object("occluder",t),!t.isBoundingSphereVisible(e)},p.equals=function(e,t){return e===t||l(e)&&l(t)&&n.equals(e.center,t.center)&&e.radius===t.radius},p.prototype.intersectPlane=function(e){return p.intersectPlane(this,e)},p.prototype.distanceSquaredTo=function(e){return p.distanceSquaredTo(this,e)},p.prototype.computePlaneDistances=function(e,t,n){return p.computePlaneDistances(this,e,t,n)},p.prototype.isOccluded=function(e){return p.isOccluded(this,e)},p.prototype.equals=function(e){return p.equals(this,e)},p.prototype.clone=function(e){return p.clone(this,e)},p.prototype.volume=function(){let e=this.radius;return R*e*e*e};var $=p;export{d as a,f as b,y as c,$ as d};