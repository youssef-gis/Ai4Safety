import{a as e}from"./chunk-3WSHJXU2.js";import{a as t}from"./chunk-OXJ2LJUE.js";import{a as i}from"./chunk-2ZPEMRCT.js";import{a as r}from"./chunk-3BSRJTW3.js";import"./chunk-VHZAK4GN.js";import"./chunk-OFCC6BNI.js";import{a as o}from"./chunk-T77EB7BE.js";import{a as n}from"./chunk-ET7KY3BS.js";import"./chunk-CUP6SILZ.js";import{a as s,b as a}from"./chunk-IYO6TYGP.js";import"./chunk-AZLP5742.js";import"./chunk-5HPISDSZ.js";import"./chunk-HSJ6GSLC.js";import"./chunk-SXKYZMEL.js";import{a as p}from"./chunk-T6Q6HX5J.js";import{a as u}from"./chunk-4MJDNHOT.js";import{b as l,c as h,d as c}from"./chunk-EDF5FKWJ.js";import{d as f}from"./chunk-XQIJGAVD.js";import"./chunk-UTYWXSQT.js";import{a as d}from"./chunk-RCHWDG3R.js";import"./chunk-4WJUWBRK.js";import"./chunk-5G23AKP3.js";import{a as y,d as g,f as m}from"./chunk-KWAHJ72S.js";import{a as H}from"./chunk-MKDADUG3.js";import{a as _,b as b}from"./chunk-NOIUI5SY.js";import{e as E}from"./chunk-XRRBRTKL.js";var k=[],P=[];function T(i){if(b.typeOf.object("options",i),b.typeOf.object("options.polygonHierarchy",i.polygonHierarchy),i.perPositionHeight&&E(i.height))throw new _("Cannot use both options.perPositionHeight and options.height");if(E(i.arcType)&&i.arcType!==t.GEODESIC&&i.arcType!==t.RHUMB)throw new _("Invalid arcType. Valid options are ArcType.GEODESIC and ArcType.RHUMB.");let r=i.polygonHierarchy,o=i.ellipsoid??g.default,n=i.granularity??H.RADIANS_PER_DEGREE,s=i.perPositionHeight??!1,a=s&&E(i.extrudedHeight),p=i.arcType??t.GEODESIC,u=i.height??0,l=i.extrudedHeight??u;if(!a){let e=Math.max(u,l);l=Math.min(u,l),u=e}this._ellipsoid=g.clone(o),this._granularity=n,this._height=u,this._extrudedHeight=l,this._arcType=p,this._polygonHierarchy=r,this._perPositionHeight=s,this._perPositionHeightExtrude=a,this._offsetAttribute=i.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=e.computeHierarchyPackedLength(r,y)+g.packedLength+8}T.pack=function(t,i,r){return b.typeOf.object("value",t),b.defined("array",i),r=r??0,r=e.packPolygonHierarchy(t._polygonHierarchy,i,r,y),g.pack(t._ellipsoid,i,r),r+=g.packedLength,i[r++]=t._height,i[r++]=t._extrudedHeight,i[r++]=t._granularity,i[r++]=+!!t._perPositionHeightExtrude,i[r++]=+!!t._perPositionHeight,i[r++]=t._arcType,i[r++]=t._offsetAttribute??-1,i[r]=t.packedLength,i};var A=g.clone(g.UNIT_SPHERE),O={polygonHierarchy:{}};T.unpack=function(t,i,r){b.defined("array",t),i=i??0;let o=e.unpackPolygonHierarchy(t,i,y);i=o.startingIndex,delete o.startingIndex;let n=g.unpack(t,i,A);i+=g.packedLength;let s=t[i++],a=t[i++],p=t[i++],u=1===t[i++],l=1===t[i++],h=t[i++],c=t[i++],f=t[i];return E(r)||(r=new T(O)),r._polygonHierarchy=o,r._ellipsoid=g.clone(n,r._ellipsoid),r._height=s,r._extrudedHeight=a,r._granularity=p,r._perPositionHeight=l,r._perPositionHeightExtrude=u,r._arcType=h,r._offsetAttribute=-1===c?void 0:c,r.packedLength=f,r},T.fromPositions=function(e){return e=e??m.EMPTY_OBJECT,b.defined("options.positions",e.positions),new T({polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,arcType:e.arcType,offsetAttribute:e.offsetAttribute})},T.createGeometry=function(y){let g=y._ellipsoid,m=y._granularity,_=y._polygonHierarchy,b=y._perPositionHeight,T=y._arcType,A=e.polygonOutlinesFromHierarchy(_,!b,g);if(0===A.length)return;let O,j=[],v=H.chordLength(m,g.maximumRadius),L=y._height,S=y._extrudedHeight,I,D;if(y._perPositionHeightExtrude||!H.equalsEpsilon(L,S,0,H.EPSILON2))for(D=0;D<A.length;D++){if((O=function(r,o,f,y,g){let m=n.fromPoints(o,r).projectPointsOntoPlane(o,k);a.computeWindingOrder2D(m)===s.CLOCKWISE&&(m.reverse(),o=o.slice().reverse());let H,_,b=o.length,E=Array(b),T=0;if(y)for(H=new Float64Array(2*b*6),_=0;_<b;++_){E[_]=T/3;let e=o[_],t=o[(_+1)%b];H[T++]=e.x,H[T++]=e.y,H[T++]=e.z,H[T++]=t.x,H[T++]=t.y,H[T++]=t.z}else{let i=0;if(g===t.GEODESIC)for(_=0;_<b;_++)i+=e.subdivideLineCount(o[_],o[(_+1)%b],f);else if(g===t.RHUMB)for(_=0;_<b;_++)i+=e.subdivideRhumbLineCount(r,o[_],o[(_+1)%b],f);for(H=new Float64Array(3*i*2),_=0;_<b;++_){let i;E[_]=T/3,g===t.GEODESIC?i=e.subdivideLine(o[_],o[(_+1)%b],f,P):g===t.RHUMB&&(i=e.subdivideRhumbLine(r,o[_],o[(_+1)%b],f,P));let n=i.length;for(let e=0;e<n;++e)H[T++]=i[e]}}b=H.length/6;let A=E.length,O=(2*b+A)*2,j=p.createTypedArray(b+A,O);for(T=0,_=0;_<b;++_)j[T++]=_,j[T++]=(_+1)%b,j[T++]=_+b,j[T++]=(_+1)%b+b;for(_=0;_<A;_++){let e=E[_];j[T++]=e,j[T++]=e+b}return new i({geometry:new h({attributes:new u({position:new c({componentDatatype:d.DOUBLE,componentsPerAttribute:3,values:H})}),indices:j,primitiveType:l.LINES})})}(g,A[D],v,b,T)).geometry=e.scaleToGeodeticHeightExtruded(O.geometry,L,S,g,b),E(y._offsetAttribute)){let e=O.geometry.attributes.position.values.length/3,t=new Uint8Array(e);y._offsetAttribute===o.TOP?t=t.fill(1,0,e/2):(I=+(y._offsetAttribute!==o.NONE),t=t.fill(I)),O.geometry.attributes.applyOffset=new c({componentDatatype:d.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}j.push(O)}else for(D=0;D<A.length;D++){if((O=function(r,o,f,y,g){let m=n.fromPoints(o,r).projectPointsOntoPlane(o,k);a.computeWindingOrder2D(m)===s.CLOCKWISE&&(m.reverse(),o=o.slice().reverse());let H,_,b=o.length,E=0;if(y)for(H=new Float64Array(2*b*3),_=0;_<b;_++){let e=o[_],t=o[(_+1)%b];H[E++]=e.x,H[E++]=e.y,H[E++]=e.z,H[E++]=t.x,H[E++]=t.y,H[E++]=t.z}else{let i=0;if(g===t.GEODESIC)for(_=0;_<b;_++)i+=e.subdivideLineCount(o[_],o[(_+1)%b],f);else if(g===t.RHUMB)for(_=0;_<b;_++)i+=e.subdivideRhumbLineCount(r,o[_],o[(_+1)%b],f);for(H=new Float64Array(3*i),_=0;_<b;_++){let i;g===t.GEODESIC?i=e.subdivideLine(o[_],o[(_+1)%b],f,P):g===t.RHUMB&&(i=e.subdivideRhumbLine(r,o[_],o[(_+1)%b],f,P));let n=i.length;for(let e=0;e<n;++e)H[E++]=i[e]}}let T=2*(b=H.length/3),A=p.createTypedArray(b,T);for(E=0,_=0;_<b-1;_++)A[E++]=_,A[E++]=_+1;return A[E++]=b-1,A[E++]=0,new i({geometry:new h({attributes:new u({position:new c({componentDatatype:d.DOUBLE,componentsPerAttribute:3,values:H})}),indices:A,primitiveType:l.LINES})})}(g,A[D],v,b,T)).geometry.attributes.position.values=a.scaleToGeodeticHeight(O.geometry.attributes.position.values,L,g,!b),E(y._offsetAttribute)){let e=O.geometry.attributes.position.values.length;I=+(y._offsetAttribute!==o.NONE);let t=new Uint8Array(e/3).fill(I);O.geometry.attributes.applyOffset=new c({componentDatatype:d.UNSIGNED_BYTE,componentsPerAttribute:1,values:t})}j.push(O)}let w=r.combineInstances(j)[0],C=f.fromVertices(w.attributes.position.values);return new h({attributes:w.attributes,indices:w.indices,primitiveType:w.primitiveType,boundingSphere:C,offsetAttribute:y._offsetAttribute})};var j=function(e,t){return E(t)&&(e=T.unpack(e,t)),e._ellipsoid=g.clone(e._ellipsoid),T.createGeometry(e)};export{j as default};