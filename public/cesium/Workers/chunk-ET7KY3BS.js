import{a as t}from"./chunk-CUP6SILZ.js";import{a as e,b as n}from"./chunk-HSJ6GSLC.js";import{a as i}from"./chunk-SXKYZMEL.js";import{a as o,b as r,h as s}from"./chunk-UTYWXSQT.js";import{a as a,c as l,d as c}from"./chunk-KWAHJ72S.js";import{a as p,b as h}from"./chunk-NOIUI5SY.js";import{e as f}from"./chunk-XRRBRTKL.js";var u=new o;function d(t,e){if(h.defined("origin",t),!f(t=(e=e??c.default).scaleToGeodeticSurface(t)))throw new p("origin must not be at the center of the ellipsoid.");let n=s.eastNorthUpToFixedFrame(t,e);this._ellipsoid=e,this._origin=t,this._xAxis=a.fromCartesian4(r.getColumn(n,0,u)),this._yAxis=a.fromCartesian4(r.getColumn(n,1,u));let o=a.fromCartesian4(r.getColumn(n,2,u));this._plane=i.fromPointNormal(t,o)}Object.defineProperties(d.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var m=new t;d.fromPoints=function(e,n){return h.defined("cartesians",e),new d(t.fromPoints(e,m).center,n)};var g=new e,_=new a;d.prototype.projectPointOntoPlane=function(t,e){h.defined("cartesian",t),g.origin=t,a.normalize(t,g.direction);let i=n.rayPlane(g,this._plane,_);if(f(i)||(a.negate(g.direction,g.direction),i=n.rayPlane(g,this._plane,_)),f(i)){let t=a.subtract(i,this._origin,i),n=a.dot(this._xAxis,t),o=a.dot(this._yAxis,t);return f(e)?(e.x=n,e.y=o,e):new l(n,o)}},d.prototype.projectPointsOntoPlane=function(t,e){h.defined("cartesians",t),f(e)||(e=[]);let n=0,i=t.length;for(let o=0;o<i;o++){let i=this.projectPointOntoPlane(t[o],e[n]);f(i)&&(e[n]=i,n++)}return e.length=n,e},d.prototype.projectPointToNearestOnPlane=function(t,e){h.defined("cartesian",t),f(e)||(e=new l),g.origin=t,a.clone(this._plane.normal,g.direction);let i=n.rayPlane(g,this._plane,_);f(i)||(a.negate(g.direction,g.direction),i=n.rayPlane(g,this._plane,_));let o=a.subtract(i,this._origin,i),r=a.dot(this._xAxis,o),s=a.dot(this._yAxis,o);return e.x=r,e.y=s,e},d.prototype.projectPointsToNearestOnPlane=function(t,e){h.defined("cartesians",t),f(e)||(e=[]);let n=t.length;e.length=n;for(let i=0;i<n;i++)e[i]=this.projectPointToNearestOnPlane(t[i],e[i]);return e};var y=new a;d.prototype.projectPointOntoEllipsoid=function(t,e){h.defined("cartesian",t),f(e)||(e=new a);let n=this._ellipsoid,i=this._origin,o=this._xAxis,r=this._yAxis;return a.multiplyByScalar(o,t.x,y),e=a.add(i,y,e),a.multiplyByScalar(r,t.y,y),a.add(e,y,e),n.scaleToGeocentricSurface(e,e),e},d.prototype.projectPointsOntoEllipsoid=function(t,e){h.defined("cartesians",t);let n=t.length;f(e)?e.length=n:e=Array(n);for(let i=0;i<n;++i)e[i]=this.projectPointOntoEllipsoid(t[i],e[i]);return e};var x=d;export{x as a};