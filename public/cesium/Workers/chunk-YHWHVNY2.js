import{g as e}from"./chunk-UTYWXSQT.js";import{a as t,e as r}from"./chunk-KWAHJ72S.js";import{a as a}from"./chunk-MKDADUG3.js";var o={},i=new t,l=new t,n=new e,s=new r;function y(a,o,y,c,m,u,x,h,z,f){let _=a+o;t.multiplyByScalar(c,Math.cos(_),i),t.multiplyByScalar(y,Math.sin(_),l),t.add(i,l,i);let p=Math.cos(a);p*=p;let O=Math.sin(a);O*=O;let d=u/Math.sqrt(x*p+m*O)/h;return e.fromAxisAngle(i,d,n),r.fromQuaternion(n,s),r.multiplyByVector(s,z,f),t.normalize(f,f),t.multiplyByScalar(f,h,f),f}var c=new t,m=new t,u=new t,x=new t;o.raisePositionsToHeight=function(e,r,a){let o=r.ellipsoid,i=r.height,l=r.extrudedHeight,n=new Float64Array(3*(a?e.length/3*2:e.length/3)),s=e.length,y=a?s:0;for(let r=0;r<s;r+=3){let s=r+1,h=r+2,z=t.fromArray(e,r,c);o.scaleToGeodeticSurface(z,z);let f=t.clone(z,m),_=o.geodeticSurfaceNormal(z,x),p=t.multiplyByScalar(_,i,u);t.add(z,p,z),a&&(t.multiplyByScalar(_,l,p),t.add(f,p,f),n[r+y]=f.x,n[s+y]=f.y,n[h+y]=f.z),n[r]=z.x,n[s]=z.y,n[h]=z.z}return n};var h=new t,z=new t,f=new t;o.computeEllipsePositions=function(e,r,o){let i=e.semiMinorAxis,l=e.semiMajorAxis,n=e.rotation,s=e.center,x=8*e.granularity,_=i*i,p=l*l,O=l*i,d=t.magnitude(s),P=t.normalize(s,h),M=t.cross(t.UNIT_Z,s,z);M=t.normalize(M,M);let T=t.cross(P,M,f),w=1+Math.ceil(a.PI_OVER_TWO/x),g=a.PI_OVER_TWO/(w-1),I=a.PI_OVER_TWO-w*g;I<0&&(w-=Math.ceil(Math.abs(I)/g));let A=w*(w+2)*2,W=r?Array(3*A):void 0,E=0,S=c,V=m,R=4*w*3,v=R-1,B=0,j=o?Array(R):void 0,k,H,U,D,G;for(S=y(I=a.PI_OVER_TWO,n,T,M,_,O,p,d,P,S),r&&(W[E++]=S.x,W[E++]=S.y,W[E++]=S.z),o&&(j[v--]=S.z,j[v--]=S.y,j[v--]=S.x),I=a.PI_OVER_TWO-g,k=1;k<w+1;++k){if(S=y(I,n,T,M,_,O,p,d,P,S),V=y(Math.PI-I,n,T,M,_,O,p,d,P,V),r){for(W[E++]=S.x,W[E++]=S.y,W[E++]=S.z,U=2*k+2,H=1;H<U-1;++H)D=H/(U-1),G=t.lerp(S,V,D,u),W[E++]=G.x,W[E++]=G.y,W[E++]=G.z;W[E++]=V.x,W[E++]=V.y,W[E++]=V.z}o&&(j[v--]=S.z,j[v--]=S.y,j[v--]=S.x,j[B++]=V.x,j[B++]=V.y,j[B++]=V.z),I=a.PI_OVER_TWO-(k+1)*g}for(k=w;k>1;--k){if(S=y(-(I=a.PI_OVER_TWO-(k-1)*g),n,T,M,_,O,p,d,P,S),V=y(I+Math.PI,n,T,M,_,O,p,d,P,V),r){for(W[E++]=S.x,W[E++]=S.y,W[E++]=S.z,U=2*(k-1)+2,H=1;H<U-1;++H)D=H/(U-1),G=t.lerp(S,V,D,u),W[E++]=G.x,W[E++]=G.y,W[E++]=G.z;W[E++]=V.x,W[E++]=V.y,W[E++]=V.z}o&&(j[v--]=S.z,j[v--]=S.y,j[v--]=S.x,j[B++]=V.x,j[B++]=V.y,j[B++]=V.z)}S=y(-(I=a.PI_OVER_TWO),n,T,M,_,O,p,d,P,S);let K={};return r&&(W[E++]=S.x,W[E++]=S.y,W[E++]=S.z,K.positions=W,K.numPts=w),o&&(j[v--]=S.z,j[v--]=S.y,j[v--]=S.x,K.outerPositions=j),K};var _=o;export{_ as a};