import{a as t}from"./chunk-RYOF6QSA.js";import{a as e}from"./chunk-T77EB7BE.js";import{b as i}from"./chunk-IYO6TYGP.js";import"./chunk-5HPISDSZ.js";import{a as r}from"./chunk-T6Q6HX5J.js";import{a as o}from"./chunk-4MJDNHOT.js";import{b as n,c as a,d as s}from"./chunk-EDF5FKWJ.js";import{d as l}from"./chunk-XQIJGAVD.js";import{i as u}from"./chunk-UTYWXSQT.js";import{a as c}from"./chunk-RCHWDG3R.js";import"./chunk-4WJUWBRK.js";import"./chunk-5G23AKP3.js";import{a as h,b as p,d as f,f as d}from"./chunk-KWAHJ72S.js";import{a as g}from"./chunk-MKDADUG3.js";import{a as m}from"./chunk-NOIUI5SY.js";import{e as _}from"./chunk-XRRBRTKL.js";var b=new l,k=new l,w=new h,y=new u;function A(e,i){let l=e._ellipsoid,u=i.height,h=i.width,p=i.northCap,f=i.southCap,d=u,g=2,m=0,_=4;p&&(g-=1,d-=1,m+=1,_-=2),f&&(g-=1,d-=1,m+=1,_-=2);let b=new Float64Array(3*(m+=g*h+2*d-_)),k=0,y=0,A;if(p)t.computePosition(i,l,!1,y,0,w),b[k++]=w.x,b[k++]=w.y,b[k++]=w.z;else for(A=0;A<h;A++)t.computePosition(i,l,!1,y,A,w),b[k++]=w.x,b[k++]=w.y,b[k++]=w.z;for(A=h-1,y=1;y<u;y++)t.computePosition(i,l,!1,y,A,w),b[k++]=w.x,b[k++]=w.y,b[k++]=w.z;if(y=u-1,!f)for(A=h-2;A>=0;A--)t.computePosition(i,l,!1,y,A,w),b[k++]=w.x,b[k++]=w.y,b[k++]=w.z;for(A=0,y=u-2;y>0;y--)t.computePosition(i,l,!1,y,A,w),b[k++]=w.x,b[k++]=w.y,b[k++]=w.z;let E=b.length/3*2,v=r.createTypedArray(b.length/3,E),H=0;for(let t=0;t<b.length/3-1;t++)v[H++]=t,v[H++]=t+1;v[H++]=b.length/3-1,v[H++]=0;let T=new a({attributes:new o,primitiveType:n.LINES});return T.attributes.position=new s({componentDatatype:c.DOUBLE,componentsPerAttribute:3,values:b}),T.indices=v,T}function E(t){let e=(t=t??d.EMPTY_OBJECT).rectangle,i=t.granularity??g.RADIANS_PER_DEGREE,r=t.ellipsoid??f.default,o=t.rotation??0;if(!_(e))throw new m("rectangle is required.");if(u._validate(e),e.north<e.south)throw new m("options.rectangle.north must be greater than options.rectangle.south");let n=t.height??0,a=t.extrudedHeight??n;this._rectangle=u.clone(e),this._granularity=i,this._ellipsoid=r,this._surfaceHeight=Math.max(n,a),this._rotation=o,this._extrudedHeight=Math.min(n,a),this._offsetAttribute=t.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}E.packedLength=u.packedLength+f.packedLength+5,E.pack=function(t,e,i){if(!_(t))throw new m("value is required");if(!_(e))throw new m("array is required");return i=i??0,u.pack(t._rectangle,e,i),i+=u.packedLength,f.pack(t._ellipsoid,e,i),i+=f.packedLength,e[i++]=t._granularity,e[i++]=t._surfaceHeight,e[i++]=t._rotation,e[i++]=t._extrudedHeight,e[i]=t._offsetAttribute??-1,e};var v=new u,H=f.clone(f.UNIT_SPHERE),T={rectangle:v,ellipsoid:H,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};E.unpack=function(t,e,i){if(!_(t))throw new m("array is required");e=e??0;let r=u.unpack(t,e,v);e+=u.packedLength;let o=f.unpack(t,e,H);e+=f.packedLength;let n=t[e++],a=t[e++],s=t[e++],l=t[e++],c=t[e];return _(i)?(i._rectangle=u.clone(r,i._rectangle),i._ellipsoid=f.clone(o,i._ellipsoid),i._surfaceHeight=a,i._rotation=s,i._extrudedHeight=l,i._offsetAttribute=-1===c?void 0:c,i):(T.granularity=n,T.height=a,T.rotation=s,T.extrudedHeight=l,T.offsetAttribute=-1===c?void 0:c,new E(T))};var D=new p;E.createGeometry=function(o){let u=o._rectangle,h=o._ellipsoid,p=t.computeOptions(u,o._granularity,o._rotation,0,y,D),f,d;if(g.equalsEpsilon(u.north,u.south,g.EPSILON10)||g.equalsEpsilon(u.east,u.west,g.EPSILON10))return;let m=o._surfaceHeight,w=o._extrudedHeight,E;if(g.equalsEpsilon(m,w,0,g.EPSILON2)){if((f=A(o,p)).attributes.position.values=i.scaleToGeodeticHeight(f.attributes.position.values,m,h,!1),_(o._offsetAttribute)){let t=f.attributes.position.values.length;E=+(o._offsetAttribute!==e.NONE);let i=new Uint8Array(t/3).fill(E);f.attributes.applyOffset=new s({componentDatatype:c.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}d=l.fromRectangle3D(u,h,m)}else{if(f=function(t,e){let o,n=t._surfaceHeight,a=t._extrudedHeight,s=t._ellipsoid,l=A(t,e),u=e.height,c=e.width,h=i.scaleToGeodeticHeight(l.attributes.position.values,n,s,!1),p=h.length,f=new Float64Array(2*p);f.set(h);let d=i.scaleToGeodeticHeight(l.attributes.position.values,a,s);f.set(d,p),l.attributes.position.values=f;let g=e.northCap,m=e.southCap,_=4;g&&(_-=1),m&&(_-=1);let b=(f.length/3+_)*2,k=r.createTypedArray(f.length/3,b);p=f.length/6;let w=0;for(let t=0;t<p-1;t++)k[w++]=t,k[w++]=t+1,k[w++]=t+p,k[w++]=t+p+1;if(k[w++]=p-1,k[w++]=0,k[w++]=p+p-1,k[w++]=p,k[w++]=0,k[w++]=p,g)o=u-1;else{let t=c-1;k[w++]=t,k[w++]=t+p,o=c+u-2}if(k[w++]=o,k[w++]=o+p,!m){let t=c+o-1;k[w++]=t,k[w]=t+p}return l.indices=k,l}(o,p),_(o._offsetAttribute)){let t=f.attributes.position.values.length/3,i=new Uint8Array(t);o._offsetAttribute===e.TOP?i=i.fill(1,0,t/2):(E=+(o._offsetAttribute!==e.NONE),i=i.fill(E)),f.attributes.applyOffset=new s({componentDatatype:c.UNSIGNED_BYTE,componentsPerAttribute:1,values:i})}let t=l.fromRectangle3D(u,h,m,k),n=l.fromRectangle3D(u,h,w,b);d=l.union(t,n)}return new a({attributes:f.attributes,indices:f.indices,primitiveType:n.LINES,boundingSphere:d,offsetAttribute:o._offsetAttribute})};var N=function(t,e){return _(e)&&(t=E.unpack(t,e)),t._ellipsoid=f.clone(t._ellipsoid),t._rectangle=u.clone(t._rectangle),E.createGeometry(t)};export{N as default};